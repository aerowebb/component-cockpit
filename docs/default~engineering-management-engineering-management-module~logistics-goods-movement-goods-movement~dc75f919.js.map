{"version":3,"sources":["webpack:///./node_modules/primeng/fileupload.js","webpack:///./node_modules/primeng/inputswitch.js","webpack:///./node_modules/primeng/progressbar.js","webpack:///./src/app/main/logistics/procurement-request/search/procurement-request-popup/procurement-request-popup.component.html","webpack:///./src/app/main/logistics/procurement-request/search/procurement-request-popup/procurement-request-popup.component.ts","webpack:///./src/app/main/logistics/procurement-request/search/procurement-request-popup/procurement-request-popup.module.ts","webpack:///./src/app/shared/components/dialog-search-work-order/dialog-search-work-order.component.html","webpack:///./src/app/shared/components/dialog-search-work-order/dialog-search-work-order.component.ts","webpack:///./src/app/shared/components/dialog-search-work-order/dialog-search-work-order.module.ts","webpack:///./src/app/shared/components/dialog-search-work-order/dialog-search-work-order.service.ts","webpack:///./src/app/shared/constants/bidt-stock-mvt-constants.ts","webpack:///./src/app/shared/utils/bido-family-variant-utils.ts","webpack:///./src/app/shared/utils/logistic-utils.ts"],"names":[],"mappings":"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","file":"default~engineering-management-engineering-management-module~logistics-goods-movement-goods-movement~dc75f919.js","sourcesContent":["/* Shorthand */\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./components/fileupload/fileupload\"));","/* Shorthand */\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./components/inputswitch/inputswitch\"));","/* Shorthand */\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./components/progressbar/progressbar\"));","module.exports = \"<a-modal class=\\\"aw-modal\\\" [(visible)]=\\\"display\\\" [width]=\\\"80\\\">\\r\\n  <a-header>\\r\\n    <div class=\\\"modal-title\\\" *ngIf=\\\"!isReadOpenMode\\\">\\r\\n      {{ getComponentName() + \\\".createProcurementRequest\\\" | translate }}\\r\\n    </div>\\r\\n    <div class=\\\"modal-title\\\" *ngIf=\\\"isReadOpenMode\\\">\\r\\n      {{ getComponentName() + \\\".modifyProcurementRequest\\\" | translate }}\\r\\n    </div>\\r\\n  </a-header>\\r\\n\\r\\n  <a-content>\\r\\n    <div class=\\\"row\\\">\\r\\n      <div class=\\\"form-group required\\\">\\r\\n        <label class=\\\"form-label\\\">{{ \\\"type\\\" | translate }}</label>\\r\\n\\r\\n        <div class=\\\"form-control\\\">\\r\\n          <p-selectButton\\r\\n            [options]=\\\"procurementRequestTypes\\\"\\r\\n            [(ngModel)]=\\\"procurementRequest.procType\\\"\\r\\n            (onChange)=\\\"onChangeProcurementRequestType()\\\"\\r\\n            [disabled]=\\\"isReadOpenMode\\\"\\r\\n          ></p-selectButton>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"row\\\">\\r\\n      <div\\r\\n        class=\\\"form-group\\\"\\r\\n        [ngClass]=\\\"\\r\\n          procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES ? 'required' : ''\\r\\n        \\\"\\r\\n        *ngIf=\\\"\\r\\n          procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE ||\\r\\n          procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_WITH_EXCHANCE ||\\r\\n          procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES\\r\\n        \\\"\\r\\n      >\\r\\n        <label class=\\\"form-label\\\">{{ getComponentName() + \\\".originalDocumentReference\\\" | translate }}</label>\\r\\n\\r\\n        <div class=\\\"form-control\\\" *ngIf=\\\"inputWorkOrder\\\">\\r\\n          {{ wo?.woCode }}\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"form-control form-control-with-modal\\\" *ngIf=\\\"!inputWorkOrder\\\">\\r\\n          <div class=\\\"form-control-data\\\" (click)=\\\"openWoDialog()\\\">\\r\\n            {{ wo?.woCode }}\\r\\n          </div>\\r\\n\\r\\n          <div *ngIf=\\\"wo\\\" class=\\\"btn-clear-wrapper\\\">\\r\\n            <i class=\\\"ui-dropdown-clear-icon pi pi-times aw-icon btn-clear\\\" aria-hidden=\\\"true\\\" (click)=\\\"eraseWo()\\\"></i>\\r\\n          </div>\\r\\n          <div class=\\\"btn-search-wrapper\\\">\\r\\n            <i class=\\\"fa fa-fw fa-search aw-icon btn-search\\\" aria-hidden=\\\"true\\\" (click)=\\\"openWoDialog()\\\"></i>\\r\\n          </div>\\r\\n        </div>\\r\\n        <div class=\\\"italic\\\" style=\\\"padding: 8px 0 0 16px;\\\" *ngIf=\\\"wo && wo?.woDescription\\\">\\r\\n          {{ wo?.woDescription }}\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"form-group\\\"></div>\\r\\n    </div>\\r\\n\\r\\n    <ng-container *ngIf=\\\"procurementRequest.procType\\\">\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"form-group\\\" style=\\\"max-width: 16rem;\\\">\\r\\n          <label class=\\\"form-label\\\">{{ \\\"status\\\" | translate }}</label>\\r\\n\\r\\n          <div class=\\\"form-control\\\">\\r\\n            <p-selectButton\\r\\n              [options]=\\\"procurementRequestStatuses\\\"\\r\\n              [(ngModel)]=\\\"procurementRequest.procStatus\\\"\\r\\n              [disabled]=\\\"isReadOpenMode\\\"\\r\\n            ></p-selectButton>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div style=\\\"margin-top: 32px;\\\">\\r\\n          <ng-container *ngIf=\\\"procurementRequest.procStatus == awPropertiesConstants.PROCUREMENT_REQUEST_STATUS_DRAFT\\\">\\r\\n            <div class=\\\"bold\\\">\\r\\n              {{ getComponentName() + \\\".draftRow1\\\" | translate }}\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"bold\\\">\\r\\n              {{ getComponentName() + \\\".draftRow2\\\" | translate }}\\r\\n            </div>\\r\\n          </ng-container>\\r\\n          <ng-container\\r\\n            *ngIf=\\\"procurementRequest.procStatus == awPropertiesConstants.PROCUREMENT_REQUEST_STATUS_RELEASED\\\"\\r\\n          >\\r\\n            <div class=\\\"bold\\\">\\r\\n              {{ getComponentName() + \\\".releasedRow1\\\" | translate }}\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"bold\\\">\\r\\n              {{ getComponentName() + \\\".releasedRow2\\\" | translate }}\\r\\n            </div>\\r\\n          </ng-container>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"form-group\\\" [class.required]=\\\"!isReadOpenMode\\\">\\r\\n          <label class=\\\"form-label\\\">{{ getComponentName() + \\\".articleCode\\\" | translate }}</label>\\r\\n\\r\\n          <div class=\\\"form-control\\\" *ngIf=\\\"inputPn\\\">\\r\\n            {{ pn?.pnCode }}\\r\\n          </div>\\r\\n\\r\\n          <div class=\\\"form-control form-control-with-modal\\\" *ngIf=\\\"!inputPn\\\" [ngClass]=\\\"{ disabled: isReadOpenMode }\\\">\\r\\n            <div class=\\\"form-control-data\\\" (click)=\\\"openPnDialog()\\\">\\r\\n              {{ pn?.pnCode }}\\r\\n            </div>\\r\\n\\r\\n            <div *ngIf=\\\"!isReadOpenMode && pn\\\" class=\\\"btn-clear-wrapper\\\">\\r\\n              <i\\r\\n                class=\\\"ui-dropdown-clear-icon pi pi-times aw-icon btn-clear\\\"\\r\\n                aria-hidden=\\\"true\\\"\\r\\n                (click)=\\\"erasePn()\\\"\\r\\n              ></i>\\r\\n            </div>\\r\\n            <div class=\\\"btn-search-wrapper\\\">\\r\\n              <i\\r\\n                *ngIf=\\\"!isReadOpenMode\\\"\\r\\n                class=\\\"fa fa-fw fa-search aw-icon btn-search\\\"\\r\\n                aria-hidden=\\\"true\\\"\\r\\n                (click)=\\\"openPnDialog()\\\"\\r\\n              ></i>\\r\\n            </div>\\r\\n          </div>\\r\\n\\r\\n          <div class=\\\"italic\\\" style=\\\"padding: 8px 0 0 16px;\\\" *ngIf=\\\"pn && pn.articleDesignation\\\">\\r\\n            {{ pn.articleDesignation }}\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"display--flex-row flex--1\\\">\\r\\n          <div class=\\\"form-group required\\\">\\r\\n            <label class=\\\"form-label\\\">\\r\\n              <div style=\\\"display: inline;\\\">\\r\\n                {{ getComponentName() + \\\".quantity\\\" | translate }}\\r\\n                <span class=\\\"italic\\\" style=\\\"display: inline;\\\" *ngIf=\\\"pn && requestedQuantity && pn.quantityPerIssue\\\">\\r\\n                  ({{ \\\"distributionQuantity\\\" | translate }} = {{ pn.quantityPerIssue | formatNumber }})\\r\\n                </span>\\r\\n              </div>\\r\\n            </label>\\r\\n\\r\\n            <div class=\\\"form-control\\\">\\r\\n              <input type=\\\"number\\\" name=\\\"quantity\\\" class=\\\"aw-input\\\" [(ngModel)]=\\\"requestedQuantity\\\" />\\r\\n            </div>\\r\\n          </div>\\r\\n\\r\\n          <div class=\\\"form-group\\\">\\r\\n            <label class=\\\"form-label\\\">{{ \\\"unit\\\" | translate }}</label>\\r\\n\\r\\n            <div class=\\\"form-control\\\">\\r\\n              <div class=\\\"form-control-generic\\\" *ngIf=\\\"pn && requestedQuantity && pn.quantityUnit\\\">\\r\\n                {{ pn.quantityUnit }}\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"row\\\">\\r\\n        <div\\r\\n          class=\\\"form-group\\\"\\r\\n          [ngClass]=\\\"{\\r\\n            required: procurementRequest.procStatus != awPropertiesConstants.PROCUREMENT_REQUEST_STATUS_DRAFT\\r\\n          }\\\"\\r\\n        >\\r\\n          <label class=\\\"form-label\\\">{{ getComponentName() + \\\".expectedDate\\\" | translate }}</label>\\r\\n\\r\\n          <div class=\\\"form-control\\\">\\r\\n            <p-calendar\\r\\n              appendTo=\\\"body\\\"\\r\\n              class=\\\"aw-calendar\\\"\\r\\n              [dateFormat]=\\\"sessionService.dateFormatPrimeNG\\\"\\r\\n              [locale]=\\\"sessionService.calendarFormat\\\"\\r\\n              [(ngModel)]=\\\"procurementRequest.requestedDate\\\"\\r\\n              showButtonBar=\\\"true\\\"\\r\\n              [monthNavigator]=\\\"true\\\"\\r\\n              [yearNavigator]=\\\"true\\\"\\r\\n              [yearRange]=\\\"sessionService.calendarYearRange\\\"\\r\\n            ></p-calendar>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div\\r\\n          class=\\\"form-group\\\"\\r\\n          style=\\\"height: 47px;\\\"\\r\\n          [ngClass]=\\\"{\\r\\n            required: procurementRequest.procStatus != awPropertiesConstants.PROCUREMENT_REQUEST_STATUS_DRAFT\\r\\n          }\\\"\\r\\n        >\\r\\n          <label class=\\\"form-label\\\">{{ getComponentName() + \\\".criticity\\\" | translate }}</label>\\r\\n\\r\\n          <div class=\\\"form-control aw-selectbutton-wrapper\\\">\\r\\n            <p-selectButton [options]=\\\"criticalities\\\" [(ngModel)]=\\\"procurementRequest.criticality\\\"></p-selectButton>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"form-group\\\">\\r\\n          <label class=\\\"form-label\\\">\\r\\n            {{ \\\"criticityReason\\\" | translate }}\\r\\n          </label>\\r\\n\\r\\n          <div class=\\\"form-control text-area\\\">\\r\\n            <textarea\\r\\n              pInputTextarea\\r\\n              autoResize=\\\"autoResize\\\"\\r\\n              class=\\\"aw-textarea\\\"\\r\\n              [rows]=\\\"2\\\"\\r\\n              [(ngModel)]=\\\"procurementRequest.criticalityReason\\\"\\r\\n            ></textarea>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"form-group\\\" [ngClass]=\\\"{ 'visibility--hidden': !isExpectedSnVisible() }\\\">\\r\\n          <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".expectedSn\\\" | translate }} </label>\\r\\n\\r\\n          <div class=\\\"form-control\\\">\\r\\n            <input\\r\\n              class=\\\"aw-input\\\"\\r\\n              name=\\\"value\\\"\\r\\n              type=\\\"text\\\"\\r\\n              [(ngModel)]=\\\"procurementRequest.procComment\\\"\\r\\n              [disabled]=\\\"isReadOpenMode\\\"\\r\\n            />\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"section\\\">\\r\\n        <h4 class=\\\"section-title\\\">{{ getComponentName() + \\\".recipient\\\" | translate }}</h4>\\r\\n\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"row\\\">\\r\\n            <div class=\\\"form-group required\\\">\\r\\n              <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".site\\\" | translate }} </label>\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <p-dropdown\\r\\n                  appendTo=\\\"body\\\"\\r\\n                  class=\\\"aw-dropdown fixed-width\\\"\\r\\n                  placeholder=\\\"&nbsp;\\\"\\r\\n                  [disabled]=\\\"isReadOpenMode || inputWorkOrder\\\"\\r\\n                  [options]=\\\"sites\\\"\\r\\n                  [showClear]=\\\"true\\\"\\r\\n                  [(ngModel)]=\\\"procurementRequest.bidtSiteByBidtSiteReceiptId\\\"\\r\\n                  (onChange)=\\\"updateWarehouses()\\\"\\r\\n                ></p-dropdown>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"form-group required\\\">\\r\\n              <label\\r\\n                class=\\\"form-label\\\"\\r\\n                *ngIf=\\\"\\r\\n                  procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE ||\\r\\n                  procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES ||\\r\\n                  procurementRequest.procType ==\\r\\n                    awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_WITH_EXCHANCE\\r\\n                \\\"\\r\\n              >\\r\\n                {{ getComponentName() + \\\".workshop\\\" | translate }}\\r\\n              </label>\\r\\n              <label\\r\\n                class=\\\"form-label\\\"\\r\\n                *ngIf=\\\"\\r\\n                  procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_STOCK_LEVELING ||\\r\\n                  procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_STOCK_LEVELING_ES ||\\r\\n                  procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_DEPLOYEMENT_BATCH\\r\\n                \\\"\\r\\n              >\\r\\n                {{ getComponentName() + \\\".warehouse\\\" | translate }}\\r\\n              </label>\\r\\n              <label\\r\\n                class=\\\"form-label\\\"\\r\\n                *ngIf=\\\"procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MISCELLANEOUS\\\"\\r\\n              >\\r\\n                {{ getComponentName() + \\\".warehouse\\\" | translate }} / {{ getComponentName() + \\\".workshop\\\" | translate }}\\r\\n              </label>\\r\\n\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <p-dropdown\\r\\n                  appendTo=\\\"body\\\"\\r\\n                  class=\\\"aw-dropdown fixed-width\\\"\\r\\n                  placeholder=\\\"&nbsp;\\\"\\r\\n                  [disabled]=\\\"isReadOpenMode || inputWorkOrder\\\"\\r\\n                  [options]=\\\"warehouses\\\"\\r\\n                  [showClear]=\\\"true\\\"\\r\\n                  [(ngModel)]=\\\"procurementRequest.bidtWarehouseByBidtWarehouseReceiptId\\\"\\r\\n                ></p-dropdown>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"section\\\">\\r\\n        <h4 class=\\\"section-title\\\">{{ getComponentName() + \\\".desiredPotential\\\" | translate }}</h4>\\r\\n\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"row\\\" *ngIf=\\\"units.length == 0\\\">\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <div class=\\\"form-control-generic italic\\\">\\r\\n                  {{ getComponentName() + \\\".noPotentialUnit\\\" | translate }}\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n\\r\\n          <div class=\\\"row\\\">\\r\\n            <div class=\\\"form-group\\\" *ngIf=\\\"units.length > 0\\\">\\r\\n              <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".value\\\" | translate }} </label>\\r\\n\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <input\\r\\n                  class=\\\"aw-input\\\"\\r\\n                  name=\\\"value\\\"\\r\\n                  type=\\\"number\\\"\\r\\n                  [(ngModel)]=\\\"procurementRequest.requestedPotential\\\"\\r\\n                />\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"form-group\\\" *ngIf=\\\"units.length > 0\\\">\\r\\n              <label class=\\\"form-label\\\">\\r\\n                {{ getComponentName() + \\\".unit\\\" | translate }}\\r\\n              </label>\\r\\n\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <p-dropdown\\r\\n                  appendTo=\\\"body\\\"\\r\\n                  class=\\\"aw-dropdown fixed-width\\\"\\r\\n                  placeholder=\\\"&nbsp;\\\"\\r\\n                  [options]=\\\"units\\\"\\r\\n                  [showClear]=\\\"true\\\"\\r\\n                  [(ngModel)]=\\\"procurementRequest.potentialUnit\\\"\\r\\n                ></p-dropdown>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"form-group\\\">\\r\\n              <label class=\\\"form-label\\\">{{ getComponentName() + \\\".calendarPotential\\\" | translate }}</label>\\r\\n\\r\\n              <div class=\\\"form-control\\\">\\r\\n                <p-calendar\\r\\n                  appendTo=\\\"body\\\"\\r\\n                  class=\\\"aw-calendar\\\"\\r\\n                  [dateFormat]=\\\"sessionService.dateFormatPrimeNG\\\"\\r\\n                  [locale]=\\\"sessionService.calendarFormat\\\"\\r\\n                  [(ngModel)]=\\\"procurementRequest.calendarPotential\\\"\\r\\n                  showButtonBar=\\\"true\\\"\\r\\n                  [monthNavigator]=\\\"true\\\"\\r\\n                  [yearNavigator]=\\\"true\\\"\\r\\n                  [yearRange]=\\\"sessionService.calendarYearRange\\\"\\r\\n                ></p-calendar>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"form-group\\\" *ngIf=\\\"units.length == 0\\\"></div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </ng-container>\\r\\n  </a-content>\\r\\n\\r\\n  <a-footer>\\r\\n    <button type=\\\"button\\\" mat-raised-button (click)=\\\"closeDialog()\\\">{{ \\\"global.cancel\\\" | translate }}</button>\\r\\n\\r\\n    <button\\r\\n      type=\\\"button\\\"\\r\\n      class=\\\"btn-with-spinner\\\"\\r\\n      color=\\\"primary\\\"\\r\\n      mat-raised-button\\r\\n      (click)=\\\"validate()\\\"\\r\\n      [disabled]=\\\"\\r\\n        !procurementRequest.procType ||\\r\\n        !pn ||\\r\\n        !requestedQuantity ||\\r\\n        !procurementRequest.bidtSiteByBidtSiteReceiptId ||\\r\\n        !procurementRequest.bidtWarehouseByBidtWarehouseReceiptId ||\\r\\n        (procurementRequest.procStatus != awPropertiesConstants.PROCUREMENT_REQUEST_STATUS_DRAFT &&\\r\\n          (!procurementRequest.criticality || !procurementRequest.requestedDate)) ||\\r\\n        (procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES && !wo)\\r\\n      \\\"\\r\\n    >\\r\\n      <span class=\\\"lds-hourglass\\\" *ngIf=\\\"saving\\\"></span>\\r\\n      {{ \\\"global.validate\\\" | translate }}\\r\\n    </button>\\r\\n  </a-footer>\\r\\n</a-modal>\\r\\n\\r\\n<aw-dialog-search-pn\\r\\n  *ngIf=\\\"showPnDialog\\\"\\r\\n  [(display)]=\\\"showPnDialog\\\"\\r\\n  (onSelected)=\\\"onSelectPn($event)\\\"\\r\\n  [showPartTypeSelection]=\\\"true\\\"\\r\\n  [checkContainer]=\\\"true\\\"\\r\\n  [withAllTypes]=\\\"true\\\"\\r\\n  [withSparePartClass]=\\\"true\\\"\\r\\n  [isSparePartClassPredefined]=\\\"\\r\\n    procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES ||\\r\\n    procurementRequest.procType == awPropertiesConstants.PROCUREMENT_REQUEST_TYPE_STOCK_LEVELING_ES\\r\\n  \\\"\\r\\n></aw-dialog-search-pn>\\r\\n\\r\\n<aw-dialog-search-work-order *ngIf=\\\"showWoDialog\\\" [(display)]=\\\"showWoDialog\\\" (onSelected)=\\\"onSelectWo($event)\\\">\\r\\n</aw-dialog-search-work-order>\\r\\n\"","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as moment from 'moment';\r\nimport { SelectItem } from 'primeng/api';\r\nimport { concatMap } from 'rxjs/operators';\r\n\r\nimport { AWPropertiesConstants } from '../../../../../shared/constants/aw-properties-constants';\r\nimport { ComponentConstants } from '../../../../../shared/constants/component-constants';\r\nimport { GenericPropertyConstants } from '../../../../../shared/constants/generic-property-constants';\r\nimport { ComponentOpenMode } from '../../../../../shared/enums/component-open-mode.enum';\r\nimport { ConfirmationService } from '../../../../../shared/services/confirmation.service';\r\nimport { MessageService } from '../../../../../shared/services/message.service';\r\nimport { PropertiesService } from '../../../../../shared/services/properties.service';\r\nimport { SerializationService } from '../../../../../shared/services/serialization.service';\r\nimport { SessionService } from '../../../../../shared/services/session.service';\r\nimport { TabService } from '../../../../../shared/services/tab.service';\r\nimport { BidmProjectDTO } from '../../../../../shared/types/api-types/bidm-project-dto.interface';\r\nimport { BidmWorkOrderDTO } from '../../../../../shared/types/api-types/bidm-work-order-dto.interface';\r\nimport { BidtProcReqItemDTO } from '../../../../../shared/types/api-types/bidt-proc-req-item-dto.interface';\r\nimport { BidtProcurementRequestDTO } from '../../../../../shared/types/api-types/bidt-procurement-request-dto.interface';\r\nimport { BidtWarehouseDTO } from '../../../../../shared/types/api-types/bidt-warehouse-dto.interface';\r\nimport { BirePnDTO } from '../../../../../shared/types/api-types/bire-pn-dto.interface';\r\nimport { DialogComponent } from '../../../../../shared/types/dialog-component';\r\nimport { LabelValue } from '../../../../../shared/types/label-value.interface';\r\nimport { PageComponentData } from '../../../../../shared/types/page-component-data.interface';\r\nimport { BidoFamilyVariantUtils } from '../../../../../shared/utils/bido-family-variant-utils';\r\nimport { ListUtils } from '../../../../../shared/utils/list-utils';\r\nimport { LogisticalUtils } from '../../../../../shared/utils/logistic-utils';\r\nimport { NumberUtils } from '../../../../../shared/utils/number-utils';\r\nimport { LogisticsService } from '../../../logistics.service';\r\n\r\nenum ComponentContext {\r\n  DEFAULT,\r\n  WORK_ORDER\r\n}\r\n\r\n@Component({\r\n  selector: 'aw-procurement-request-popup',\r\n  templateUrl: './procurement-request-popup.component.html'\r\n})\r\nexport class ProcurementRequestPopupComponent extends DialogComponent implements OnInit {\r\n  @Input('pn')\r\n  public inputPn?: BirePnDTO;\r\n\r\n  @Input('procurementRequest')\r\n  public inputProcurementRequest?: BidtProcurementRequestDTO;\r\n\r\n  @Input('bidtProcReqItem')\r\n  public inputBidtProcReqItem?: BidtProcReqItemDTO;\r\n\r\n  @Input('workOrder')\r\n  public inputWorkOrder?: BidmWorkOrderDTO;\r\n\r\n  @Input('workOrderStatus')\r\n  public inputWorkOrderStatus?: string;\r\n\r\n  @Input('workPackage')\r\n  public inputWorkPackage?: BidmProjectDTO;\r\n\r\n  @Output()\r\n  public readonly onValidate: EventEmitter<BidtProcurementRequestDTO>;\r\n\r\n  public readonly awPropertiesConstants: typeof AWPropertiesConstants;\r\n\r\n  public criticalities: LabelValue<string>[];\r\n  public procurementRequestStatuses: LabelValue<string>[];\r\n  public procurementRequestTypes: SelectItem[];\r\n  public sites: LabelValue<number>[];\r\n  public units: LabelValue<string>[];\r\n  public warehouses: LabelValue<number>[];\r\n\r\n  public currentComponentContext: ComponentContext;\r\n  public pn: BirePnDTO | undefined;\r\n  public wo: BidmWorkOrderDTO | undefined;\r\n  public procurementRequest: BidtProcurementRequestDTO;\r\n  public requestedQuantity: string | undefined;\r\n\r\n  public showPnDialog: boolean;\r\n  public showWoDialog: boolean;\r\n\r\n  public saving: boolean;\r\n\r\n  private engineeringPnTypes: LabelValue<string>[];\r\n\r\n  public constructor(\r\n    public readonly sessionService: SessionService,\r\n    private readonly confirmationService: ConfirmationService,\r\n    private readonly logisticsService: LogisticsService,\r\n    private readonly messageService: MessageService,\r\n    private readonly propertiesService: PropertiesService,\r\n    private readonly serializationService: SerializationService,\r\n    private readonly tabService: TabService,\r\n    public readonly translateService: TranslateService\r\n  ) {\r\n    super(ComponentOpenMode.Read, 'ProcurementRequestPopupComponent');\r\n\r\n    this.awPropertiesConstants = AWPropertiesConstants;\r\n    this.onValidate = new EventEmitter<BidtProcurementRequestDTO>();\r\n\r\n    this.criticalities = [];\r\n    this.procurementRequestStatuses = [];\r\n    this.procurementRequestTypes = [];\r\n    this.sites = [];\r\n    this.units = [];\r\n    this.warehouses = [];\r\n\r\n    this.pn = undefined;\r\n    this.wo = undefined;\r\n    this.procurementRequest = {};\r\n    this.requestedQuantity = undefined;\r\n\r\n    this.showPnDialog = false;\r\n    this.showWoDialog = false;\r\n\r\n    this.loadCriticalities();\r\n    this.loadSites();\r\n\r\n    this.propertiesService.getValue(GenericPropertyConstants.ENGINEERING_PN_TYPES_MAP).subscribe({\r\n      next: (pnTypes) => {\r\n        this.engineeringPnTypes = ListUtils.orEmpty(pnTypes);\r\n      }\r\n    });\r\n  }\r\n\r\n  public ngOnInit(): void {\r\n    this.initCurrentComponentContext();\r\n\r\n    this.loadProcurementRequestTypes();\r\n    this.loadProcurementRequestStatuses();\r\n\r\n    if (this.inputProcurementRequest) {\r\n      // Edit mode\r\n      this.updateOpenMode(ComponentOpenMode.Read);\r\n      this.initWithProcurementRequest();\r\n      this.loadWarehouses(this.procurementRequest.bidtSiteByBidtSiteReceiptId as number);\r\n      if (!!this.inputWorkOrder) {\r\n        this.wo = this.inputWorkOrder;\r\n      }\r\n    } else {\r\n      // Create mode\r\n      this.updateOpenMode(ComponentOpenMode.Write);\r\n      this.procurementRequest = {\r\n        procStatus: AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_RELEASED,\r\n        requestedDate: new Date()\r\n      };\r\n\r\n      this.initWithPn(this.inputPn);\r\n      this.initWithWorkOrder(this.inputWorkPackage, this.inputWorkOrder, this.inputWorkOrderStatus);\r\n\r\n      if (!this.inputWorkOrder) {\r\n        this.loadUserSite();\r\n      }\r\n    }\r\n  }\r\n\r\n  // ////////////////////////////////////////////////////////////////////////////\r\n\r\n  public erasePn(): void {\r\n    this.pn = undefined;\r\n  }\r\n\r\n  public eraseWo(): void {\r\n    this.wo = undefined;\r\n  }\r\n\r\n  public onChangeProcurementRequestType(): void {\r\n    if (!this.isWorkOrderContext) {\r\n      this.updateWarehouses();\r\n    }\r\n  }\r\n\r\n  public onSelectPn(pn: BirePnDTO): void {\r\n    this.pn = pn;\r\n\r\n    this.loadUnits(pn);\r\n\r\n    if (this.isWorkOrderContext) {\r\n      this.procurementRequest.procType =\r\n        pn.sparePartClassCode === AWPropertiesConstants.SPC_REPAIRABLE_KEY\r\n          ? AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES\r\n          : AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE;\r\n    }\r\n  }\r\n\r\n  public onSelectWo(workOrder: BidmWorkOrderDTO): void {\r\n    this.wo = workOrder;\r\n    this.procurementRequest.requestedDate = workOrder.woScheduledStartDate || this.procurementRequest.requestedDate;\r\n    this.loadProcurementRequestStatuses();\r\n    if (workOrder.bidtWarehouseId) {\r\n      this.logisticsService.getWarehouseById(workOrder.bidtWarehouseId).subscribe({\r\n        next: (warehouse: BidtWarehouseDTO) => {\r\n          if (warehouse) {\r\n            this.procurementRequest.bidtWarehouseByBidtWarehouseReceiptId = warehouse.wareHouseId as number;\r\n            this.procurementRequest.bidtSiteByBidtSiteReceiptId = warehouse.bidtSiteId as number;\r\n            this.loadWarehouses(this.procurementRequest.bidtSiteByBidtSiteReceiptId);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    if (this.procurementRequest.procType === AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES) {\r\n      this.logisticsService.findBirePn({ pnCode: workOrder.assetPn }).subscribe({\r\n        next: (pn) => {\r\n          if (pn) {\r\n            this.onSelectPn(pn);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  public openPnDialog(): void {\r\n    if (!this.isReadOpenMode) {\r\n      this.showPnDialog = true;\r\n    }\r\n  }\r\n\r\n  public openWoDialog(): void {\r\n    this.showWoDialog = true;\r\n  }\r\n\r\n  public updateWarehouses(): void {\r\n    this.procurementRequest.bidtWarehouseByBidtWarehouseReceiptId = undefined;\r\n    this.warehouses = [];\r\n\r\n    if (this.procurementRequest.bidtSiteByBidtSiteReceiptId) {\r\n      this.loadWarehouses(this.procurementRequest.bidtSiteByBidtSiteReceiptId);\r\n    }\r\n  }\r\n\r\n  public validate() {\r\n    if (moment(this.procurementRequest.requestedDate).isBefore(moment(), 'day')) {\r\n      this.messageService.showWarningMessage(this.getTranslateKey('warningOnRequestDateInPast'));\r\n    } else if (Number(this.requestedQuantity) <= 0) {\r\n      this.messageService.showWarningMessage(this.getTranslateKey('warningOnNegativeQuantity'));\r\n    } else {\r\n      this.saving = true;\r\n\r\n      // regression Here on edit, items has no more id !!\r\n      this.addItemDataToProcurementRequest();\r\n      this.addWorkOrderDataToProcurementRequest();\r\n\r\n      this.logisticsService.checkQuantityConsistency(this.procurementRequest).subscribe({\r\n        next: (consistent) => {\r\n          if (consistent) {\r\n            this.checkSimilarProcurementRequestThenUpdate();\r\n          } else {\r\n            this.confirmationService.confirm({\r\n              messageKey: this.getTranslateKey('quantityNotConsistent'),\r\n              contextKeys: [this.getTranslateKey('confirmContinue')],\r\n              accept: () => {\r\n                this.checkSimilarProcurementRequestThenUpdate();\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private checkSimilarProcurementRequestThenUpdate(): void {\r\n    const procurementRequestCriteria = {\r\n      assetCode: this.isWorkOrderContext && this.inputWorkPackage ? this.inputWorkPackage.assetCode : undefined,\r\n      procReqItemQuantity: this.requestedQuantity,\r\n      procReqItemPnCode: this.pn ? this.pn.pnCode : undefined,\r\n      withAlternatives: true,\r\n      bidtProcurementRequest: {\r\n        bidtSiteByBidtSiteReceiptId: this.procurementRequest.bidtSiteByBidtSiteReceiptId\r\n      },\r\n      procReqStatusExcluded: [\r\n        AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_CANCELED,\r\n        AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_CLOSED\r\n      ]\r\n    };\r\n    this.logisticsService.findProcurementRequestsByCriteria(procurementRequestCriteria).subscribe({\r\n      next: (existingProcurementRequests) => {\r\n        if (ListUtils.isNullOrEmpty(existingProcurementRequests)) {\r\n          this.checkPnIsInApplicableConfigurationThenUpdate();\r\n        } else {\r\n          const existingProcCode = existingProcurementRequests[0].procCode;\r\n\r\n          this.confirmationService.confirm({\r\n            interpolateParams: { procCode: existingProcCode },\r\n            messageKey: this.getTranslateKey('similarProcurementRequest'),\r\n            contextKeys: [this.getTranslateKey('confirmContinue')],\r\n            accept: () => {\r\n              this.checkPnIsInApplicableConfigurationThenUpdate();\r\n            }\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private isPnTypePresentInEngineeringPnTypes(pn: BirePnDTO): boolean {\r\n    return this.engineeringPnTypes.some((pnType) => pnType.value === pn.pnType);\r\n  }\r\n\r\n  private checkPnIsInApplicableConfigurationThenUpdate(): void {\r\n    if (!this.isWorkOrderContext || !this.isPnTypePresentInEngineeringPnTypes(this.pn as BirePnDTO)) {\r\n      this.updateProcurementRequest();\r\n    } else {\r\n      if (this.inputWorkPackage && this.inputWorkPackage.assetCode) {\r\n        this.logisticsService\r\n          .findEquipment({ equipmentCode: this.inputWorkPackage.assetCode })\r\n          .pipe(\r\n            concatMap((equipment) => {\r\n              const input = {\r\n                familyCode: BidoFamilyVariantUtils.getFamilyCodeFromFamilyVariantCode(equipment.familyVariantCode),\r\n                structureType: AWPropertiesConstants.STRUCTURE_TYPE_IPC_KEY,\r\n                variantCode: BidoFamilyVariantUtils.getVariantCodeFromFamilyVariantCode(equipment.familyVariantCode),\r\n                pnCode: (this.pn as BirePnDTO).pnCode\r\n              };\r\n\r\n              return this.logisticsService.findBireVersionPnsByFamilyAndVariantAndPnCode(input);\r\n            })\r\n          )\r\n          .subscribe({\r\n            next: (bireVersionPns) => {\r\n              if (ListUtils.isNullOrEmpty(bireVersionPns)) {\r\n                this.confirmationService.confirm({\r\n                  messageKey: this.getTranslateKey('pnNotInApplicableConfiguration'),\r\n                  contextKeys: [this.getTranslateKey('confirmContinue')],\r\n                  accept: () => {\r\n                    this.updateProcurementRequest();\r\n                  }\r\n                });\r\n              } else {\r\n                this.updateProcurementRequest();\r\n              }\r\n            }\r\n          });\r\n      } else {\r\n        this.updateProcurementRequest();\r\n      }\r\n    }\r\n  }\r\n\r\n  // ////////////////////////////////////////////////////////////////////////////\r\n\r\n  private get isDefaultContext(): boolean {\r\n    return this.currentComponentContext === ComponentContext.DEFAULT;\r\n  }\r\n\r\n  private get isWorkOrderContext(): boolean {\r\n    return this.currentComponentContext === ComponentContext.WORK_ORDER;\r\n  }\r\n\r\n  private addItemDataToProcurementRequest(): void {\r\n    // correction regression by 'someone' on edit mode\r\n    if (\r\n      !!this.inputProcurementRequest &&\r\n      !!this.procurementRequest.bidtProcReqItems &&\r\n      !!this.procurementRequest.bidtProcReqItems[0]\r\n    ) {\r\n      this.procurementRequest.bidtProcReqItems[0] = {\r\n        ...this.procurementRequest.bidtProcReqItems[0],\r\n        birePn: this.pn,\r\n        birePnPnCode: this.pn ? this.pn.pnCode : undefined,\r\n        requestedQuantity: this.requestedQuantity\r\n      };\r\n    } else {\r\n      this.procurementRequest.bidtProcReqItems = [\r\n        {\r\n          birePn: this.pn,\r\n          birePnPnCode: this.pn ? this.pn.pnCode : undefined,\r\n          requestedQuantity: this.requestedQuantity\r\n        }\r\n      ];\r\n    }\r\n  }\r\n\r\n  private addWorkOrderDataToProcurementRequest(): void {\r\n    if (this.wo) {\r\n      const workOrder = this.wo as BidmWorkOrderDTO;\r\n      this.procurementRequest.bidmWorkOrderProjectId = workOrder.projectId;\r\n      this.procurementRequest.bidmWorkOrderWoId = workOrder.woId;\r\n    }\r\n  }\r\n\r\n  private initCurrentComponentContext(): void {\r\n    this.currentComponentContext = this.inputWorkOrder ? ComponentContext.WORK_ORDER : ComponentContext.DEFAULT;\r\n  }\r\n\r\n  private initWithPn(pn: BirePnDTO | undefined): void {\r\n    this.pn = pn;\r\n  }\r\n\r\n  private initWithProcurementRequest(): void {\r\n    this.procurementRequest = this.inputProcurementRequest as BidtProcurementRequestDTO;\r\n    this.procurementRequest.bidtProcReqItems = [this.inputBidtProcReqItem as BidtProcReqItemDTO];\r\n    this.pn =\r\n      this.procurementRequest.bidtProcReqItems && this.procurementRequest.bidtProcReqItems.length === 1\r\n        ? this.procurementRequest.bidtProcReqItems[0].birePn\r\n        : undefined;\r\n\r\n    this.requestedQuantity =\r\n      this.procurementRequest.bidtProcReqItems &&\r\n      this.procurementRequest.bidtProcReqItems.length === 1 &&\r\n      this.procurementRequest.bidtProcReqItems[0].requestedQuantity\r\n        ? NumberUtils.roundNumber(\r\n            NumberUtils.fromString(this.procurementRequest.bidtProcReqItems[0].requestedQuantity),\r\n            2\r\n          ).toString()\r\n        : undefined;\r\n\r\n    if (this.pn) {\r\n      this.loadUnits(this.pn);\r\n    }\r\n  }\r\n\r\n  private initWithWorkOrder(\r\n    workPackage: BidmProjectDTO | undefined,\r\n    workOrder: BidmWorkOrderDTO | undefined,\r\n    workOrderStatus: string | undefined\r\n  ): void {\r\n    if (workPackage && workOrder) {\r\n      this.procurementRequest.procType = AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE;\r\n      this.procurementRequest.requestedDate = workOrder.woScheduledStartDate || this.procurementRequest.requestedDate;\r\n      this.wo = workOrder;\r\n\r\n      this.logisticsService.findAllBireSite().subscribe({\r\n        next: (sites) => {\r\n          const matchingSite = sites.find((site) => site.siteCode === workPackage.bireRepairCenterCode);\r\n          if (matchingSite) {\r\n            this.procurementRequest.bidtSiteByBidtSiteReceiptId = matchingSite.siteId as number;\r\n\r\n            if (workOrder.bidtWarehouseId) {\r\n              this.logisticsService.getWarehouseById(workOrder.bidtWarehouseId).subscribe({\r\n                next: (warehouse) => {\r\n                  if (warehouse) {\r\n                    this.procurementRequest.bidtWarehouseByBidtWarehouseReceiptId = warehouse.wareHouseId as number;\r\n\r\n                    this.loadWarehouses(this.procurementRequest.bidtSiteByBidtSiteReceiptId as number);\r\n                  }\r\n                }\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      if (\r\n        workOrderStatus &&\r\n        (workOrderStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_PLANNED ||\r\n          workOrderStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_RELEASED)\r\n      ) {\r\n        this.procurementRequest.procStatus =\r\n          workOrderStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_PLANNED\r\n            ? AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_PLANNED\r\n            : AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_RELEASED;\r\n      }\r\n    }\r\n  }\r\n\r\n  private loadCriticalities() {\r\n    this.propertiesService.getValue(GenericPropertyConstants.LOGISTICAL_CRITICALITY_MAP).subscribe({\r\n      next: (criticalities) => {\r\n        this.criticalities = LogisticalUtils.sortCriticities(criticalities);\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadProcurementRequestStatuses(): void {\r\n    this.propertiesService.getValue(GenericPropertyConstants.PROCUREMENT_REQUEST_STATUS_MAP).subscribe({\r\n      next: (procurementRequestStatuses) => {\r\n        const draftStatus = procurementRequestStatuses.find(\r\n          (e) => e.value === AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_DRAFT\r\n        ) as LabelValue<string>;\r\n        const plannedStatus = procurementRequestStatuses.find(\r\n          (e) => e.value === AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_PLANNED\r\n        ) as LabelValue<string>;\r\n        const releasedStatus = procurementRequestStatuses.find(\r\n          (e) => e.value === AWPropertiesConstants.PROCUREMENT_REQUEST_STATUS_RELEASED\r\n        ) as LabelValue<string>;\r\n\r\n        this.procurementRequestStatuses = [draftStatus];\r\n\r\n        if ((this.isWorkOrderContext && this.inputWorkOrder) || !!this.wo) {\r\n          if (\r\n            this.inputWorkOrderStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_PLANNED ||\r\n            (!!this.wo && this.wo.calculatedStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_PLANNED)\r\n          ) {\r\n            this.procurementRequestStatuses.push(plannedStatus);\r\n          } else if (\r\n            this.inputWorkOrderStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_RELEASED ||\r\n            (!!this.wo && this.wo.calculatedStatus === AWPropertiesConstants.AIRM_OPERATION_STATUS_RELEASED)\r\n          ) {\r\n            this.procurementRequestStatuses.push(releasedStatus);\r\n          }\r\n        } else {\r\n          this.procurementRequestStatuses.push(releasedStatus);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadProcurementRequestTypes(): void {\r\n    this.propertiesService.getValue(GenericPropertyConstants.PROCUREMENT_REQUEST_TYPE_MAP).subscribe({\r\n      next: (types) => {\r\n        const allowedTypes = this.isWorkOrderContext\r\n          ? [\r\n              AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE,\r\n              AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_WITH_EXCHANCE,\r\n              AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_ES\r\n            ]\r\n          : types.map((type) => type.value);\r\n\r\n        this.procurementRequestTypes = types\r\n          .filter((type) => allowedTypes.includes(type.value))\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadSites(): void {\r\n    this.logisticsService.findAllBireSite().subscribe({\r\n      next: (sites) => {\r\n        this.sites = sites\r\n          .map((res) => {\r\n            return {\r\n              label: `${res.siteCode} - ${res.siteName}`,\r\n              value: res.siteId as number\r\n            };\r\n          })\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadUnits(pn: BirePnDTO) {\r\n    this.logisticsService.findBidoCounterReferencesByPnCode({ pnCode: pn.pnCode as string }).subscribe({\r\n      next: (counterReferences) => {\r\n        this.units = counterReferences\r\n          .map((counterReference) => {\r\n            return {\r\n              label: `${counterReference.unitCode} (${counterReference.counterCode})`,\r\n              value: counterReference.counterCode as string\r\n            };\r\n          })\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadUserSite(): void {\r\n    this.sessionService.getUserSiteId().subscribe({\r\n      next: (site) => {\r\n        this.procurementRequest.bidtSiteByBidtSiteReceiptId = site ? site.siteId : undefined;\r\n\r\n        if (this.procurementRequest.bidtSiteByBidtSiteReceiptId) {\r\n          this.loadUserWarehouse(this.procurementRequest.bidtSiteByBidtSiteReceiptId);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadUserWarehouse(siteId: number): void {\r\n    this.sessionService.getUserWarehouseId().subscribe({\r\n      next: (warehouse) => {\r\n        if (warehouse && warehouse.wareHouseId) {\r\n          this.loadWarehouses(siteId);\r\n\r\n          this.procurementRequest.bidtWarehouseByBidtWarehouseReceiptId = warehouse ? warehouse.wareHouseId : undefined;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadWarehouses(siteId: number): void {\r\n    this.logisticsService.getWarehousesBySiteId(siteId).subscribe({\r\n      next: (warehouses) => {\r\n        const whCategory =\r\n          this.procurementRequest.procType === AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE ||\r\n          this.procurementRequest.procType === AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_MAINTENANCE_WITH_EXCHANCE\r\n            ? AWPropertiesConstants.WAREHOUSE_CATEGORY_WORKSHOP\r\n            : this.procurementRequest.procType === AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_STOCK_LEVELING ||\r\n              this.procurementRequest.procType === AWPropertiesConstants.PROCUREMENT_REQUEST_TYPE_DEPLOYEMENT_BATCH\r\n            ? AWPropertiesConstants.WAREHOUSE_CATEGORY_WAREHOUSE\r\n            : undefined;\r\n\r\n        this.warehouses = warehouses\r\n          .filter((warehouse) => !whCategory || warehouse.whCategory === whCategory)\r\n          .map((warehouse) => {\r\n            return {\r\n              label: `${warehouse.whCode}` + (warehouse.whName ? ` - ${warehouse.whName}` : ''),\r\n              value: warehouse.wareHouseId as number\r\n            };\r\n          })\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  private openProcurementRequest(procurementRequest: BidtProcurementRequestDTO): void {\r\n    const data: PageComponentData = {\r\n      id: this.tabService.generateId(),\r\n      componentId: ComponentConstants.LOG_PROCUREMENT_REQUEST_FORM,\r\n      objectId: this.serializationService.serialize({ id: procurementRequest.id }),\r\n      openMode: ComponentOpenMode.Read\r\n    };\r\n    const labelKey = 'transaction.' + data.componentId;\r\n    this.tabService.open(this.tabService.create(data, labelKey, true));\r\n  }\r\n\r\n  private updateProcurementRequest(): void {\r\n    const service$ = this.inputProcurementRequest\r\n      ? this.logisticsService.addOrUpdateProcurementRequest(this.procurementRequest)\r\n      : this.isWorkOrderContext || this.wo\r\n      ? this.logisticsService.createProcurementRequestFromWorkOrder(this.procurementRequest)\r\n      : this.logisticsService.createProcurementRequest(this.procurementRequest);\r\n\r\n    service$.subscribe({\r\n      next: (procurementRequest) => {\r\n        const message = this.inputProcurementRequest\r\n          ? 'successOnUpdateProcurementRequest'\r\n          : 'successOnCreateProcurementRequest';\r\n        this.messageService.showSuccessMessage(this.getTranslateKey(message));\r\n\r\n        this.onValidate.emit(procurementRequest);\r\n        this.closeDialog();\r\n\r\n        if (this.isDefaultContext) {\r\n          this.openProcurementRequest(procurementRequest);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  public isExpectedSnVisible(): boolean {\r\n    return (\r\n      !!this.pn &&\r\n      !!this.pn.traceability &&\r\n      (this.pn.traceability === AWPropertiesConstants.PN_TRACEABILITY_BY_BATCH ||\r\n        this.pn.traceability === AWPropertiesConstants.PN_TRACEABILITY_BY_SN ||\r\n        this.pn.traceability === AWPropertiesConstants.PN_TRACEABILITY_BY_PACKAGING_BATCH_AND_SN)\r\n    );\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CalendarModule } from 'primeng/calendar';\r\nimport { CheckboxModule } from 'primeng/checkbox';\r\nimport { DropdownModule } from 'primeng/dropdown';\r\nimport { FileUploadModule } from 'primeng/fileupload';\r\nimport { InputSwitchModule } from 'primeng/inputswitch';\r\nimport { ProgressBarModule } from 'primeng/progressbar';\r\nimport { SelectButtonModule } from 'primeng/selectbutton';\r\nimport { TableModule as PrimeNgTableModule } from 'primeng/table';\r\nimport { TooltipModule } from 'primeng/tooltip';\r\n\r\nimport { AngularCommonSharedModule } from '../../../../../shared/angular-common-shared.module';\r\nimport { AngularGenericTemplatesSharedModule } from '../../../../../shared/angular-generic-templates-shared-module';\r\nimport { AppCommonSharedModule } from '../../../../../shared/app-common-shared.module';\r\nimport { ComponentSidebarModule } from '../../../../../shared/components/component-sidebar/component-sidebar.mdule';\r\nimport { DialogSearchPnModule } from '../../../../../shared/components/dialog-search-pn/dialog-search-pn.module';\r\nimport { DialogSearchWorkOrderModule } from '../../../../../shared/components/dialog-search-work-order/dialog-search-work-order.module';\r\nimport { ManageSearchCriteriaModule } from '../../../../../shared/components/manage-search-criteria/manage-search-criteria.module';\r\nimport { ModalModule } from '../../../../../shared/components/modal/modal.module';\r\nimport { TableModule } from '../../../../../shared/components/table/table.module';\r\n\r\nimport { ProcurementRequestPopupComponent } from './procurement-request-popup.component';\r\n\r\n/******************************************************************************\r\n * Modules\r\n *************************************************************************** */\r\n\r\nconst EXTERNAL_MODULES = [\r\n  TooltipModule,\r\n  DropdownModule,\r\n  FileUploadModule,\r\n  InputSwitchModule,\r\n  SelectButtonModule,\r\n  TableModule,\r\n  CheckboxModule,\r\n  ComponentSidebarModule,\r\n  CalendarModule,\r\n  PrimeNgTableModule,\r\n  ProgressBarModule,\r\n  ModalModule\r\n];\r\n\r\nconst INTERNAL_MODULES = [DialogSearchPnModule, DialogSearchWorkOrderModule];\r\n\r\n@NgModule({\r\n  exports: [ProcurementRequestPopupComponent],\r\n  declarations: [ProcurementRequestPopupComponent],\r\n  imports: [\r\n    AngularCommonSharedModule,\r\n    AngularGenericTemplatesSharedModule,\r\n    AppCommonSharedModule,\r\n    ManageSearchCriteriaModule,\r\n    ...EXTERNAL_MODULES,\r\n    ...INTERNAL_MODULES\r\n  ]\r\n})\r\nexport class ProcurementRequestPopupModule {}\r\n","module.exports = \"<a-modal class=\\\"aw-modal\\\" [(visible)]=\\\"display\\\" [width]=\\\"65\\\">\\r\\n  <a-header>\\r\\n    <div class=\\\"modal-title\\\">{{ getComponentName() + \\\".title\\\" | translate }}</div>\\r\\n\\r\\n    <i class=\\\"material-icons aw-icon aw-icon-with-border\\\" (click)=\\\"onCancel()\\\">close</i>\\r\\n  </a-header>\\r\\n\\r\\n  <a-content>\\r\\n    <div class=\\\"search-dialog-container\\\">\\r\\n      <div class=\\\"section search-criteria-section\\\">\\r\\n        <h4 class=\\\"section-title\\\">{{ \\\"global.search\\\" | translate }}</h4>\\r\\n\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"column\\\">\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col\\\">\\r\\n                <div class=\\\"form-group\\\">\\r\\n                  <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".bidmProjectNumber\\\" | translate }} </label>\\r\\n\\r\\n                  <div class=\\\"form-control\\\">\\r\\n                    <input class=\\\"aw-input\\\" type=\\\"text\\\" [(ngModel)]=\\\"searchObject.projectCriteria.projectNumber\\\" />\\r\\n                  </div>\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".woCode\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <input class=\\\"aw-input\\\" type=\\\"text\\\" [(ngModel)]=\\\"searchObject.workOrderCriteria.woCode\\\" />\\r\\n                </div>\\r\\n              </div>\\r\\n\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".woType\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <p-dropdown\\r\\n                    class=\\\"aw-dropdown fixed-width\\\"\\r\\n                    [options]=\\\"propertyWoType\\\"\\r\\n                    [(ngModel)]=\\\"searchObject.workOrderCriteria.woType\\\"\\r\\n                    [showClear]=\\\"true\\\"\\r\\n                    placeholder=\\\"&nbsp;\\\"\\r\\n                    appendTo=\\\"body\\\"\\r\\n                  ></p-dropdown>\\r\\n                </div>\\r\\n              </div>\\r\\n\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".statusState\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <p-dropdown\\r\\n                    class=\\\"aw-dropdown fixed-width\\\"\\r\\n                    [options]=\\\"status\\\"\\r\\n                    [(ngModel)]=\\\"searchObject.workOrderCriteria.calculatedStatus\\\"\\r\\n                    [showClear]=\\\"true\\\"\\r\\n                    placeholder=\\\"&nbsp;\\\"\\r\\n                    appendTo=\\\"body\\\"\\r\\n                  ></p-dropdown>\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".woDescription\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <input class=\\\"aw-input\\\" type=\\\"text\\\" [(ngModel)]=\\\"searchObject.workOrderCriteria.woDescription\\\" />\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".site\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <p-dropdown\\r\\n                    appendTo=\\\"body\\\"\\r\\n                    class=\\\"aw-dropdown fixed-width\\\"\\r\\n                    placeholder=\\\"&nbsp;\\\"\\r\\n                    [options]=\\\"sites\\\"\\r\\n                    [showClear]=\\\"true\\\"\\r\\n                    [(ngModel)]=\\\"bidtSiteId\\\"\\r\\n                    (onChange)=\\\"updateWarehouses()\\\"\\r\\n                    [disabled]=\\\"disable\\\"\\r\\n                  ></p-dropdown>\\r\\n                </div>\\r\\n              </div>\\r\\n\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\"> {{ getComponentName() + \\\".workshop\\\" | translate }} </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <p-dropdown\\r\\n                    appendTo=\\\"body\\\"\\r\\n                    class=\\\"aw-dropdown fixed-width\\\"\\r\\n                    placeholder=\\\"&nbsp;\\\"\\r\\n                    [options]=\\\"warehouses\\\"\\r\\n                    [showClear]=\\\"true\\\"\\r\\n                    [(ngModel)]=\\\"searchObject.workOrderCriteria.bidtWarehouseId\\\"\\r\\n                    [disabled]=\\\"disable\\\"\\r\\n                  ></p-dropdown>\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\">{{ getComponentName() + \\\".pn\\\" | translate }}</label>\\r\\n\\r\\n                <div class=\\\"form-control form-control-with-modal\\\">\\r\\n                  <div class=\\\"form-control-data\\\" (click)=\\\"openPnDialog()\\\">\\r\\n                    {{ pn?.pnCode }}\\r\\n                  </div>\\r\\n\\r\\n                  <div *ngIf=\\\"pn\\\" class=\\\"btn-clear-wrapper\\\">\\r\\n                    <i\\r\\n                      class=\\\"ui-dropdown-clear-icon pi pi-times aw-icon btn-clear\\\"\\r\\n                      aria-hidden=\\\"true\\\"\\r\\n                      (click)=\\\"erasePn()\\\"\\r\\n                    ></i>\\r\\n                  </div>\\r\\n                  <div class=\\\"btn-search-wrapper\\\">\\r\\n                    <i class=\\\"fa fa-fw fa-search aw-icon btn-search\\\" aria-hidden=\\\"true\\\" (click)=\\\"openPnDialog()\\\"></i>\\r\\n                  </div>\\r\\n                </div>\\r\\n\\r\\n                <div class=\\\"italic\\\" style=\\\"padding: 8px 0 0 16px;\\\" *ngIf=\\\"pn && pn.articleDesignation\\\">\\r\\n                  {{ pn.articleDesignation }}\\r\\n                </div>\\r\\n              </div>\\r\\n\\r\\n              <div class=\\\"form-group\\\">\\r\\n                <label class=\\\"form-label\\\">\\r\\n                  {{ getComponentName() + \\\".sn\\\" | translate }}\\r\\n                </label>\\r\\n\\r\\n                <div class=\\\"form-control\\\">\\r\\n                  <input class=\\\"aw-input\\\" type=\\\"text\\\" [(ngModel)]=\\\"searchObject.workOrderCriteria.assetSn\\\" />\\r\\n                </div>\\r\\n              </div>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row search-criteria-footer\\\">\\r\\n              <div class=\\\"search-actions\\\">\\r\\n                <button type=\\\"button\\\" color=\\\"primary\\\" mat-raised-button (click)=\\\"searchWorkOrders()\\\">\\r\\n                  <span>{{ \\\"global.toSearch\\\" | translate }}</span>\\r\\n                </button>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <div class=\\\"section results-section\\\">\\r\\n        <h4 class=\\\"section-title\\\">\\r\\n          {{ \\\"global.results\\\" | translate }} ({{ resultsTable.list ? resultsTable.list.length : 0 }})\\r\\n        </h4>\\r\\n\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <p-table\\r\\n            [resizableColumns]=\\\"true\\\"\\r\\n            #ptable\\r\\n            class=\\\"aw-table2\\\"\\r\\n            [columns]=\\\"resultsTableCols\\\"\\r\\n            [value]=\\\"resultsTable.list\\\"\\r\\n            [(selection)]=\\\"selectedObject\\\"\\r\\n            selectionMode=\\\"single\\\"\\r\\n            dataKey=\\\"woCode\\\"\\r\\n            [scrollable]=\\\"true\\\"\\r\\n            (onRowUnselect)=\\\"onRowUnselect()\\\"\\r\\n          >\\r\\n            <ng-template pTemplate=\\\"emptymessage\\\">\\r\\n              <span *ngIf=\\\"!isLoading\\\"> &nbsp;</span>\\r\\n\\r\\n              <div *ngIf=\\\"isLoading\\\" class=\\\"aw-table-loading-indicator\\\">\\r\\n                <div class=\\\"loading-message\\\">{{ \\\"table.loadingData\\\" | translate }}</div>\\r\\n                <div class=\\\"lds-hourglass\\\"></div>\\r\\n              </div>\\r\\n            </ng-template>\\r\\n\\r\\n            <ng-template pTemplate=\\\"caption\\\">\\r\\n              <div class=\\\"aw-table-header\\\">\\r\\n                <div class=\\\"aw-table-global-filter\\\">\\r\\n                  <label class=\\\"aw-table-global-filter-label\\\">\\r\\n                    <i class=\\\"fa fa-fw fa-search\\\" aria-hidden=\\\"true\\\"></i>\\r\\n                  </label>\\r\\n\\r\\n                  <input\\r\\n                    #ptableGlobalFilter\\r\\n                    class=\\\"aw-table-global-filter-input\\\"\\r\\n                    type=\\\"text\\\"\\r\\n                    placeholder=\\\"{{ 'table.globalFilterText' | translate }}\\\"\\r\\n                    (input)=\\\"ptable.filterGlobal($event.target.value, 'contains')\\\"\\r\\n                  />\\r\\n                </div>\\r\\n              </div>\\r\\n            </ng-template>\\r\\n\\r\\n            <ng-template pTemplate=\\\"colgroup\\\" let-columns>\\r\\n              <colgroup>\\r\\n                <col *ngFor=\\\"let col of columns\\\" [ngStyle]=\\\"{ width: col.width }\\\" />\\r\\n              </colgroup>\\r\\n            </ng-template>\\r\\n\\r\\n            <ng-template pTemplate=\\\"header\\\" let-columns>\\r\\n              <tr>\\r\\n                <th pResizableColumn *ngFor=\\\"let col of columns\\\" [ngStyle]=\\\"{ 'text-align': col.alignment }\\\">\\r\\n                  {{ getComponentName() + \\\".\\\" + col.field | translate }}\\r\\n                </th>\\r\\n              </tr>\\r\\n            </ng-template>\\r\\n\\r\\n            <ng-template pTemplate=\\\"body\\\" let-rowData let-columns=\\\"columns\\\" let-rowIndex=\\\"rowIndex\\\">\\r\\n              <tr [pSelectableRow]=\\\"rowData\\\" [pSelectableRowIndex]=\\\"rowIndex\\\">\\r\\n                <td *ngFor=\\\"let col of columns\\\" [ngStyle]=\\\"{ 'text-align': col.alignment }\\\">\\r\\n                  <span *ngIf=\\\"!col.isDate && col.field !== 'woType' && col.field !== 'calculatedStatus'\\\">\\r\\n                    {{ rowData[col.field] }}\\r\\n                  </span>\\r\\n                  <span\\r\\n                    *ngIf=\\\"\\r\\n                      !col.isDate && rowData[col.field] && (col.field === 'woType' || col.field === 'calculatedStatus')\\r\\n                    \\\"\\r\\n                  >\\r\\n                    {{ getComponentName() + \\\".\\\" + rowData[col.field] | translate }}\\r\\n                  </span>\\r\\n                  <span *ngIf=\\\"col.isDate\\\">\\r\\n                    {{ rowData[col.field] | date: \\\"short\\\":\\\"\\\":translateService.currentLang }}\\r\\n                  </span>\\r\\n                </td>\\r\\n              </tr>\\r\\n            </ng-template>\\r\\n          </p-table>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </a-content>\\r\\n\\r\\n  <a-footer>\\r\\n    <button type=\\\"button\\\" mat-raised-button (click)=\\\"onCancel()\\\">\\r\\n      <span>{{ \\\"global.cancel\\\" | translate }}</span>\\r\\n    </button>\\r\\n\\r\\n    <button *ngIf=\\\"!isOneObjectSelected()\\\" color=\\\"primary\\\" type=\\\"button\\\" mat-raised-button (click)=\\\"onValidate()\\\">\\r\\n      {{ \\\"global.validate\\\" | translate }}\\r\\n    </button>\\r\\n  </a-footer>\\r\\n</a-modal>\\r\\n\\r\\n<aw-dialog-search-pn\\r\\n  *ngIf=\\\"showPnDialog\\\"\\r\\n  [(display)]=\\\"showPnDialog\\\"\\r\\n  (onSelected)=\\\"onSelectPn($event)\\\"\\r\\n  [showPartTypeSelection]=\\\"true\\\"\\r\\n></aw-dialog-search-pn>\\r\\n\"","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { SelectItem } from 'primeng/api';\r\n\r\nimport { LogisticsService } from '../../../main/logistics/logistics.service';\r\nimport { DialogWorkOrderEditService } from '../../../main/maintenance/work-package/form/popups/dialog-work-order-edition/dialog-work-order-edition.service';\r\nimport { WorkOrderOVSInputDTO } from '../../../shared/types/api-output-types/ovs-popup/work-order-ovs-input-dto.interface';\r\nimport { SearchResultsDTO } from '../../../shared/types/api-types/search-results-dto.interface';\r\nimport { DialogComponent } from '../../../shared/types/dialog-component';\r\nimport { TableColumn } from '../../../shared/types/table-column.interface';\r\nimport { AWPropertiesConstants } from '../../constants/aw-properties-constants';\r\nimport { BidoFunctionTypeConstants } from '../../constants/bido-function-type-constants';\r\nimport { ComponentOpenMode } from '../../enums/component-open-mode.enum';\r\nimport { MessageService } from '../../services/message.service';\r\nimport { SessionService } from '../../services/session.service';\r\nimport { UsersForWorkOrderInput } from '../../types/api-input-types/user-profile-management/users-for-work-order.interface';\r\nimport { BidmWorkOrderDTO } from '../../types/api-types/bidm-work-order-dto.interface';\r\nimport { BidoUserDTO } from '../../types/api-types/bido-user-dto.interface';\r\nimport { BidtSiteDTO } from '../../types/api-types/bidt-site-dto.interface';\r\nimport { BirePnDTO } from '../../types/api-types/bire-pn-dto.interface';\r\nimport { LabelValue } from '../../types/label-value.interface';\r\n\r\nimport { DialogSearchWorkOrderService } from './dialog-search-work-order.service';\r\n\r\n@Component({\r\n  selector: 'aw-dialog-search-work-order',\r\n  templateUrl: 'dialog-search-work-order.component.html'\r\n})\r\nexport class DialogSearchWorkOrderComponent extends DialogComponent implements OnInit {\r\n  public resultsTableCols: TableColumn[];\r\n  public resultsTable: SearchResultsDTO<BidmWorkOrderDTO>;\r\n  public selectedObject: BidmWorkOrderDTO;\r\n  public searchObject: WorkOrderOVSInputDTO;\r\n  public isLoading: boolean;\r\n  public bidtSiteId: string | undefined;\r\n\r\n  // DropDown\r\n  public propertyWoType: LabelValue<string>[];\r\n  public sites: LabelValue<string>[];\r\n  public status: LabelValue<string>[];\r\n  public userList: SelectItem[];\r\n  public warehouses: LabelValue<number>[];\r\n  public sitesList: BidtSiteDTO[];\r\n\r\n  @Output()\r\n  public onSelected = new EventEmitter<BidmWorkOrderDTO>();\r\n\r\n  @Input()\r\n  public sourceSearchObject: WorkOrderOVSInputDTO;\r\n\r\n  public showPnDialog: boolean;\r\n  public pn: BirePnDTO | undefined;\r\n  public disable: boolean;\r\n\r\n  public constructor(\r\n    public dialogSearchWorkOrderService: DialogSearchWorkOrderService,\r\n    public readonly sessionService: SessionService,\r\n    public translateService: TranslateService,\r\n    private readonly messageService: MessageService,\r\n    private readonly logisticsService: LogisticsService,\r\n    private readonly dialogWorkOrderEditService: DialogWorkOrderEditService\r\n  ) {\r\n    super(ComponentOpenMode.Write, 'DialogSearchWorkOrderComponent');\r\n    this.isLoading = false;\r\n    this.resultsTable = {\r\n      list: [],\r\n      moreResults: false\r\n    };\r\n\r\n    this.searchObject = {\r\n      projectCriteria: {},\r\n      workOrderCriteria: {}\r\n    };\r\n\r\n    this.selectedObject = {};\r\n    this.showPnDialog = false;\r\n\r\n    this.resultsTableCols = [\r\n      { field: 'bidmProjectNumber', alignment: 'left', width: '100px' },\r\n      { field: 'woCode', alignment: 'left', width: '100px' },\r\n      { field: 'woType', alignment: 'left', width: '100px' },\r\n      { field: 'calculatedStatus', alignment: 'left', width: '100px' },\r\n      { field: 'woDescription', alignment: 'left', width: '250px' }\r\n    ];\r\n    this.propertyWoType = [];\r\n    this.status = [];\r\n    this.sites = [];\r\n    this.warehouses = [];\r\n\r\n    this.loadPrCategories();\r\n    this.loadSites();\r\n    this.loadStatus();\r\n    this.loadUser();\r\n  }\r\n\r\n  public ngOnInit(): void {\r\n    if (!!this.sourceSearchObject) {\r\n      this.bidtSiteId = this.sourceSearchObject.projectCriteria.bireRepairCenterCode;\r\n\r\n      this.updateWarehouses();\r\n      this.searchObject.workOrderCriteria.bidtWarehouseId = this.sourceSearchObject.workOrderCriteria.bidtWarehouseId;\r\n      this.disable = true;\r\n    }\r\n  }\r\n\r\n  public searchWorkOrders(): void {\r\n    this.isLoading = true;\r\n    const site = this.sitesList.find((s) => s.siteId === Number(this.bidtSiteId));\r\n    if (!!site) {\r\n      this.searchObject.projectCriteria.bireRepairCenterCode = site.siteCode;\r\n    }\r\n    this.dialogSearchWorkOrderService.findWorkOrder(this.searchObject).subscribe(\r\n      (results) => {\r\n        if (results) {\r\n          this.resultsTable = results;\r\n          this.isLoading = false;\r\n        }\r\n      },\r\n      () => {\r\n        this.messageService.showErrorMessage(this.getTranslateKey('errorOnSearch'));\r\n      }\r\n    );\r\n  }\r\n\r\n  public onValidate(): void {\r\n    this.onSelected.emit(this.selectedObject);\r\n    this.selectedObject = {};\r\n    this.display = false;\r\n  }\r\n\r\n  // Clean the selectedObject object if the row is unselect\r\n  public onRowUnselect(): void {\r\n    this.selectedObject = {};\r\n  }\r\n\r\n  // Clean all the object on rerender\r\n  public onShow(): void {\r\n    this.selectedObject = {};\r\n    this.resultsTable = {\r\n      list: [],\r\n      moreResults: false\r\n    };\r\n  }\r\n\r\n  /*\r\n    <summary>Close the pop up on cancel</summary>\r\n    */\r\n  public onCancel(): void {\r\n    this.selectedObject = {};\r\n    this.resultsTable = {\r\n      list: [],\r\n      moreResults: false\r\n    };\r\n    this.display = false;\r\n  }\r\n\r\n  public isOneObjectSelected(): boolean {\r\n    return !this.selectedObject.woCode;\r\n  }\r\n\r\n  private loadPrCategories(): void {\r\n    this.dialogSearchWorkOrderService.getAirmWorkOrderTypeList().subscribe(\r\n      (result) => {\r\n        this.propertyWoType = result;\r\n      },\r\n      () => {\r\n        this.messageService.showErrorMessage(this.getTranslateKey('errorOnGetWoTypeList'));\r\n      }\r\n    );\r\n  }\r\n\r\n  private loadSites(): void {\r\n    this.sitesList = [];\r\n    this.logisticsService.findAllBireSite().subscribe({\r\n      next: (sites) => {\r\n        this.sitesList = sites;\r\n        this.sites = sites\r\n          .map((res) => {\r\n            return {\r\n              label: `${res.siteCode} - ${res.siteName}`,\r\n              value: !!res.siteId ? res.siteId.toString() : ''\r\n            };\r\n          })\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadStatus(): void {\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_SIMULATED,\r\n      label: this.translateService.instant('simulated') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_PLANNED,\r\n      label: this.translateService.instant('planned') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_RELEASED,\r\n      label: this.translateService.instant('released') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_ONGOING,\r\n      label: this.translateService.instant('onGoing') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_TO_BE_CONFIRMED,\r\n      label: this.translateService.instant('toBeConfirmed') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_OPERATION_STATUS_PERFORMED,\r\n      label: this.translateService.instant('performed') as string\r\n    });\r\n    this.status.push({\r\n      value: AWPropertiesConstants.AIRM_PROJECT_STATUS_CLOSE,\r\n      label: this.translateService.instant('closed') as string\r\n    });\r\n  }\r\n\r\n  private loadUser(): void {\r\n    const param: UsersForWorkOrderInput = {\r\n      useCaseCode: BidoFunctionTypeConstants.UC_AIRM_RECEPTION\r\n    };\r\n\r\n    this.dialogWorkOrderEditService.findUsersWithUseCaseForWorkOrder(param).subscribe((data: BidoUserDTO[]) => {\r\n      this.userList = data.map((user) => {\r\n        return {\r\n          label: `${user.lastname} ${user.firstname}`,\r\n          value: user.userId\r\n        };\r\n      });\r\n    });\r\n  }\r\n\r\n  private loadWarehouses(siteId: number): void {\r\n    this.logisticsService.getWarehousesBySiteId(siteId).subscribe({\r\n      next: (warehouses) => {\r\n        this.warehouses = warehouses\r\n          .map((warehouse) => {\r\n            return {\r\n              label: `${warehouse.whCode}` + (warehouse.whName ? ` - ${warehouse.whName}` : ''),\r\n              value: warehouse.wareHouseId as number\r\n            };\r\n          })\r\n          .sort((s1, s2) => s1.label.localeCompare(s2.label));\r\n      }\r\n    });\r\n  }\r\n\r\n  public updateWarehouses(): void {\r\n    this.searchObject.workOrderCriteria.bidtWarehouseId = undefined;\r\n    this.warehouses = [];\r\n\r\n    if (this.bidtSiteId && !isNaN(Number(this.bidtSiteId))) {\r\n      this.loadWarehouses(Number(this.bidtSiteId));\r\n    }\r\n  }\r\n\r\n  public openPnDialog(): void {\r\n    this.showPnDialog = true;\r\n  }\r\n\r\n  public onSelectPn(pn: BirePnDTO): void {\r\n    this.pn = pn;\r\n    this.searchObject.workOrderCriteria.assetPn = this.pn.articleDesignation;\r\n  }\r\n\r\n  public erasePn(): void {\r\n    this.pn = undefined;\r\n    this.searchObject.workOrderCriteria.assetPn = undefined;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CalendarModule } from 'primeng/calendar';\r\nimport { DropdownModule } from 'primeng/dropdown';\r\nimport { TableModule } from 'primeng/table';\r\n\r\nimport { LogisticsService } from '../../../main/logistics/logistics.service';\r\nimport { DialogWorkOrderEditService } from '../../../main/maintenance/work-package/form/popups/dialog-work-order-edition/dialog-work-order-edition.service';\r\nimport { AngularCommonSharedModule } from '../../angular-common-shared.module';\r\nimport { AngularGenericTemplatesSharedModule } from '../../angular-generic-templates-shared-module';\r\nimport { AppCommonSharedModule } from '../../app-common-shared.module';\r\nimport { DialogSearchPnModule } from '../dialog-search-pn/dialog-search-pn.module';\r\nimport { ModalModule } from '../modal/modal.module';\r\n\r\nimport { DialogSearchWorkOrderComponent } from './dialog-search-work-order.component';\r\nimport { DialogSearchWorkOrderService } from './dialog-search-work-order.service';\r\n\r\n/******************************************************************************\r\n * Modules\r\n *************************************************************************** */\r\n\r\nconst EXTERNAL_MODULES = [CalendarModule, DropdownModule, TableModule];\r\n\r\nconst INTERNAL_MODULES = [DialogSearchPnModule, ModalModule];\r\n\r\n/******************************************************************************\r\n * Components\r\n *************************************************************************** */\r\n\r\nconst COMPONENTS = [DialogSearchWorkOrderComponent];\r\n\r\n/******************************************************************************\r\n * Services\r\n *************************************************************************** */\r\n\r\nconst SERVICES = [DialogSearchWorkOrderService, DialogWorkOrderEditService, LogisticsService];\r\n\r\n@NgModule({\r\n  declarations: [...COMPONENTS],\r\n  exports: [...COMPONENTS],\r\n  imports: [\r\n    AngularCommonSharedModule,\r\n    AngularGenericTemplatesSharedModule,\r\n    AppCommonSharedModule,\r\n    ...EXTERNAL_MODULES,\r\n    ...INTERNAL_MODULES\r\n  ],\r\n  providers: [...SERVICES]\r\n})\r\nexport class DialogSearchWorkOrderModule {}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\n\r\nimport { AircraftMaintenanceApi } from '../../../shared/api/aircraft-maintenance.api';\r\nimport { WorkOrderOVSInputDTO } from '../../../shared/types/api-output-types/ovs-popup/work-order-ovs-input-dto.interface';\r\nimport { SearchResultsDTO } from '../../../shared/types/api-types/search-results-dto.interface';\r\nimport { AbstractAwHttpService } from '../../http/abstract-aw-http';\r\nimport { AppConfigService } from '../../services/app-config.service';\r\nimport { BidmWorkOrderDTO } from '../../types/api-types/bidm-work-order-dto.interface';\r\nimport { LabelValue } from '../../types/label-value.interface';\r\n\r\n@Injectable()\r\nexport class DialogSearchWorkOrderService extends AbstractAwHttpService {\r\n  public constructor(\r\n    http: HttpClient,\r\n    appConfigService: AppConfigService,\r\n    private readonly aircraftMaintenanceApi: AircraftMaintenanceApi\r\n  ) {\r\n    super(http, appConfigService);\r\n  }\r\n\r\n  public findWorkOrder(criteria: WorkOrderOVSInputDTO): Observable<SearchResultsDTO<BidmWorkOrderDTO>> {\r\n    return super.post<WorkOrderOVSInputDTO, SearchResultsDTO<BidmWorkOrderDTO>>(\r\n      this.aircraftMaintenanceApi.findBidmWorkOrdersByCriteria,\r\n      criteria\r\n    );\r\n  }\r\n\r\n  public getAirmWorkOrderTypeList(): Observable<LabelValue<string>[]> {\r\n    return super.get<LabelValue<string>[]>(this.aircraftMaintenanceApi.getAirmWorkOrderTypeList);\r\n  }\r\n\r\n  public getAirmProjectStatusList(): Observable<LabelValue<string>[]> {\r\n    return super.get<LabelValue<string>[]>(this.aircraftMaintenanceApi.getAirmProjectStatusList);\r\n  }\r\n}\r\n","export class BidtStockMvtConstants {\r\n  public static readonly MVT_WAY_CREDIT: string = 'C';\r\n\r\n  public static readonly MVT_WAY_DEBIT: string = 'D';\r\n\r\n  public static readonly MVT_WAY_TRANSFER: string = 'T';\r\n\r\n  public static readonly MVT_RECONDITIONING: string = 'MVT_RECONDITIONING';\r\n\r\n  public static readonly MVT_RELATED_FL: string = 'MVT_RELATED_FL';\r\n\r\n  public static readonly MVT_STORAGE_COUNTER_RESET = 'MVT_STORAGE_COUNTER_RESET';\r\n\r\n  public static readonly MVT_STATUS_STEP_WAY_BEFORE_TRANSFERT = 0;\r\n  public static readonly MVT_STATUS_STEP_WAY_TRANSFERT = 1;\r\n  public static readonly MVT_STATUS_STEP_WAY_DEBIT = 2;\r\n  public static readonly MVT_STATUS_STEP_WAY_CREDIT = 3;\r\n}\r\n","import { StringUtils } from '../../shared/utils/string-utils';\r\n\r\nexport class BidoFamilyVariantUtils {\r\n  public static buildFamilyVariantCode(\r\n    familyCode: string | undefined,\r\n    variantCode: string | undefined\r\n  ): string | undefined {\r\n    if (StringUtils.isNullOrEmpty(familyCode) || StringUtils.isNullOrEmpty(variantCode)) {\r\n      return undefined;\r\n    } else {\r\n      return `${familyCode}-${variantCode}`;\r\n    }\r\n  }\r\n\r\n  public static getFamilyCodeFromFamilyVariantCode(familyVariantCode: string | undefined): string | undefined {\r\n    return !!familyVariantCode && familyVariantCode.indexOf('-') > -1\r\n      ? familyVariantCode.substring(0, familyVariantCode.indexOf('-'))\r\n      : undefined;\r\n  }\r\n\r\n  public static getVariantCodeFromFamilyVariantCode(familyVariantCode: string | undefined): string | undefined {\r\n    return !!familyVariantCode && familyVariantCode.indexOf('-') > -1\r\n      ? familyVariantCode.substring(familyVariantCode.indexOf('-') + 1)\r\n      : undefined;\r\n  }\r\n}\r\n","import * as moment from 'moment';\r\n\r\nimport { AWPropertiesConstants } from '../constants/aw-properties-constants';\r\nimport { BidtStockMvtConstants } from '../constants/bidt-stock-mvt-constants';\r\nimport { BidtProcReqItemDTO } from '../types/api-types/bidt-proc-req-item-dto.interface';\r\nimport { BidtProcurementRequestDTO } from '../types/api-types/bidt-procurement-request-dto.interface';\r\nimport { BidtStockMvtDTO } from '../types/api-types/bidt-stock-mvt-dto.interface';\r\nimport { BidtTorItemDTO } from '../types/api-types/bidt-tor-item-dto.interface';\r\nimport { LabelValue } from '../types/label-value.interface';\r\n\r\nimport { ListUtils } from './list-utils';\r\nimport { NumberUtils } from './number-utils';\r\nimport { StringUtils } from './string-utils';\r\n\r\nexport interface ProcurementRequestItemRow {\r\n  obj: BidtProcReqItemDTO;\r\n  allNb: number;\r\n  servedNb: number;\r\n  bookedNb: number;\r\n  notBookedNb: number;\r\n  warehouseName: string | undefined;\r\n  siteName: string | undefined;\r\n}\r\n\r\nexport interface ProcurementRequestReverseItemRow {\r\n  obj: BidtTorItemDTO;\r\n  allNb: number;\r\n  reversedNb: number;\r\n  notReversedNb: number;\r\n  warehouseReceiptName: string | undefined;\r\n  siteReceiptName: string | undefined;\r\n  warehouseIssueName: string | undefined;\r\n  siteIssueName: string | undefined;\r\n}\r\n\r\nexport interface ServerdAndBookedIndicators {\r\n  bookedNb: number;\r\n  notBookedNb: number;\r\n  isServed: boolean;\r\n  servedNb: number;\r\n}\r\n\r\nexport class LogisticalUtils {\r\n  public static sortCriticities(criticities: LabelValue<string>[]): LabelValue<string>[] {\r\n    return criticities.sort((c1, _c2) => {\r\n      if (c1.value === AWPropertiesConstants.LOGISTICAL_CRITICALITY_ROUTINE) {\r\n        return -1;\r\n      } else if (c1.value === AWPropertiesConstants.LOGISTICAL_CRITICALITY_IMMEDIATE) {\r\n        return 1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  public static getServedIndicators(\r\n    procurementRequest: BidtProcurementRequestDTO\r\n  ): ServerdAndBookedIndicators | undefined {\r\n    if (procurementRequest.bidtWarehouseReceipt && procurementRequest.bidtWarehouseReceipt.whCategory) {\r\n      const procurementRequestItems = this.buildProcurementRequestItemsRows(procurementRequest);\r\n\r\n      return this.computeProcurementRequestProgress(procurementRequestItems);\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  public static buildProcurementRequestItemsRows(procurementRequest: BidtProcurementRequestDTO) {\r\n    return ListUtils.orEmpty(procurementRequest.bidtProcReqItems)\r\n      .map((bidtProcReqItem) => this.buildProcurementRequestItemRow(bidtProcReqItem))\r\n      .sort((x, y) => {\r\n        if (x.obj.statusDate && y.obj.statusDate) {\r\n          return moment(x.obj.statusDate).isBefore(y.obj.statusDate) ? -1 : 1;\r\n        } else if (x.obj.statusDate) {\r\n          return -1;\r\n        } else {\r\n          return 1;\r\n        }\r\n      });\r\n  }\r\n\r\n  public static buildProcurementRequestItemRow(procurementRequestItem: BidtProcReqItemDTO): ProcurementRequestItemRow {\r\n    const progress = this.computeProcurementRequestItemProgress(\r\n      procurementRequestItem.workshopEntries,\r\n      procurementRequestItem.requestedQuantity\r\n    );\r\n\r\n    return {\r\n      obj: procurementRequestItem,\r\n      allNb: progress.allNb,\r\n      servedNb: progress.servedNb,\r\n      bookedNb: progress.bookedNb,\r\n      notBookedNb: progress.notBookedNb,\r\n      warehouseName: undefined,\r\n      siteName: undefined\r\n    };\r\n  }\r\n\r\n  public static computeProcurementRequestReverseItemProgress(\r\n    stockMvts: BidtStockMvtDTO[] | undefined\r\n  ): { allNb: number; reversedNb: number; notReversedNb: number } {\r\n    const filteredStockMvts = ListUtils.orEmpty(stockMvts).filter(\r\n      (stockMvt) => stockMvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_CREDIT\r\n    );\r\n    const reversedStockMvts = filteredStockMvts.filter(\r\n      (stockMvt) => stockMvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n    );\r\n\r\n    const allNb = filteredStockMvts\r\n      .map((stockMvt) => (stockMvt.stockMvtQuantity ? Number(stockMvt.stockMvtQuantity) : 0))\r\n      .reduce((acc, x) => acc + x, 0);\r\n    const reversedNb = reversedStockMvts\r\n      .map((stockMvt) => (stockMvt.stockMvtQuantity ? Number(stockMvt.stockMvtQuantity) : 0))\r\n      .reduce((acc, x) => acc + x, 0);\r\n    const notReversedNb = allNb - reversedNb;\r\n\r\n    return { allNb, reversedNb, notReversedNb };\r\n  }\r\n\r\n  public static computeProcurementRequestItemProgress(\r\n    stockMvts: BidtStockMvtDTO[] | undefined,\r\n    requestedQuantity: string | undefined\r\n  ): { allNb: number; bookedNb: number; notBookedNb: number; servedNb: number } {\r\n    const filteredStockMvts = ListUtils.orEmpty(stockMvts).filter(\r\n      (stockMvt) => stockMvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_CREDIT\r\n    );\r\n    const servedStockMvts = filteredStockMvts.filter(\r\n      (stockMvt) => stockMvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n    );\r\n    const servedNb = servedStockMvts\r\n      .map((stockMvt) => (stockMvt.stockMvtQuantity ? Number(stockMvt.stockMvtQuantity) : 0))\r\n      .reduce((acc, x) => acc + x, 0);\r\n    const bookedNb = filteredStockMvts\r\n      .filter(\r\n        (stockMvt) =>\r\n          stockMvt.mvtStatus !== AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY &&\r\n          stockMvt.mvtStatus !== AWPropertiesConstants.MM_MVT_STATUS_CANCELED_KEY &&\r\n          (!StringUtils.isNullOrEmpty(stockMvt.stockMvtSn) || !StringUtils.isNullOrEmpty(stockMvt.stockMvtBatchNumber))\r\n      )\r\n      .map((stockMvt) => (stockMvt.stockMvtQuantity ? Number(stockMvt.stockMvtQuantity) : 0))\r\n      .reduce((acc, x) => acc + x, 0);\r\n\r\n    const notServedNb = StringUtils.isNullOrEmpty(requestedQuantity)\r\n      ? 0\r\n      : Math.max(0, NumberUtils.fromString(requestedQuantity as string) - servedNb - bookedNb);\r\n\r\n    return { allNb: filteredStockMvts.length, bookedNb, notBookedNb: notServedNb, servedNb };\r\n  }\r\n\r\n  public static computeProcurementRequestProgress(\r\n    procurementRequestItems: ProcurementRequestItemRow[]\r\n  ): ServerdAndBookedIndicators {\r\n    const procurementRequestQuantity = ListUtils.orEmpty(procurementRequestItems)\r\n      .map((e) => e.obj.requestedQuantity)\r\n      .filter((quantity) => !StringUtils.isNullOrEmpty(quantity))\r\n      .map((quantity) => NumberUtils.fromString(quantity as string))\r\n      .reduce((acc, x) => acc + x, 0);\r\n    const procurementRequestProgress = ListUtils.orEmpty(procurementRequestItems).reduce(\r\n      (a, b) => {\r\n        return {\r\n          bookedNb: a.bookedNb + b.bookedNb,\r\n          notBookedNb: a.notBookedNb + b.notBookedNb,\r\n          servedNb: a.servedNb + b.servedNb\r\n        };\r\n      },\r\n      {\r\n        bookedNb: 0,\r\n        notBookedNb: 0,\r\n        servedNb: 0\r\n      }\r\n    );\r\n\r\n    return {\r\n      bookedNb: procurementRequestProgress.bookedNb,\r\n      notBookedNb: procurementRequestProgress.notBookedNb,\r\n      isServed: procurementRequestProgress.servedNb === procurementRequestQuantity,\r\n      servedNb: procurementRequestProgress.servedNb\r\n    };\r\n  }\r\n\r\n  public static isReversedTransfer(mvts: BidtStockMvtDTO[]): boolean {\r\n    return mvts.some(\r\n      (mvt) =>\r\n        mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_CREDIT &&\r\n        mvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n    );\r\n  }\r\n\r\n  public static isReversingTransfer(mvts: BidtStockMvtDTO[]): boolean {\r\n    return (\r\n      mvts.some(\r\n        (mvt) =>\r\n          mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_DEBIT &&\r\n          mvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n      ) &&\r\n      mvts.some(\r\n        (mvt) =>\r\n          mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_CREDIT &&\r\n          mvt.mvtStatus !== AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n      )\r\n    );\r\n  }\r\n\r\n  public static isExecutingTransfer(mvts: BidtStockMvtDTO[]): boolean {\r\n    return (\r\n      !mvts.some(\r\n        (mvt) =>\r\n          mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_DEBIT &&\r\n          mvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n      ) &&\r\n      !mvts.some(\r\n        (mvt) =>\r\n          mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_CREDIT &&\r\n          mvt.mvtStatus === AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n      )\r\n    );\r\n  }\r\n\r\n  public static isWaitingTransfer(mvts: BidtStockMvtDTO[]): boolean {\r\n    return mvts.some(\r\n      (mvt) =>\r\n        mvt.stockMvtWay === BidtStockMvtConstants.MVT_WAY_TRANSFER &&\r\n        mvt.mvtStatus !== AWPropertiesConstants.MM_MVT_STATUS_EXECUTED_KEY\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}