<div class="grid-cell-header">
  <div class="grid-cell-title-container">
    <h3 class="grid-cell-title">
      {{ getComponentName() + ".engineOil" | translate }}
      ({{ table ? table.length : 0 }})
    </h3>
  </div>
</div>

<div class="grid-cell-content">
  <div class="row">
    <p-table
      [resizableColumns]="true"
      #ptable
      class="aw-table2"
      [columns]="tableColList"
      [value]="table"
      [(selection)]="tableSelectedList"
      [scrollable]="true"
      dataKey="designation"
    >
      <ng-template pTemplate="emptymessage">
        <span *ngIf="!tableLoading"> &nbsp;</span>

        <div *ngIf="tableLoading" class="aw-table-loading-indicator">
          <div class="loading-message">{{ "table.loadingData" | translate }}</div>
          <div class="lds-hourglass"></div>
        </div>
      </ng-template>

      <ng-template pTemplate="caption">
        <div class="aw-table-header" [ngClass]="{ 'rows-selected': tableSelectedList.length > 0 }">
          <div class="aw-table-global-filter">
            <label class="aw-table-global-filter-label">
              <i class="fa fa-fw fa-search" aria-hidden="true"></i>
            </label>

            <input
              class="aw-table-global-filter-input"
              type="text"
              placeholder="{{ 'table.globalFilterText' | translate }}"
              (input)="ptable.filterGlobal($event.target.value, 'contains')"
            />
          </div>

          <div class="aw-table-actions">
            <button
              *ngIf="!tableLoading && tableSelectedList.length === 1"
              type="button"
              mat-raised-button
              (click)="editReplenishmentMeasure()"
            >
              {{ getComponentName() + ".editReplenishmentMeasure" | translate }}
            </button>

            <button
              *ngIf="!tableLoading && table.length > 0 && tableSelectedList.length === 1"
              type="button"
              mat-raised-button
              (click)="resetOilConsumption()"
            >
              {{ getComponentName() + ".resetOilConsumption" | translate }}
            </button>
          </div>
        </div>
      </ng-template>

      <ng-template pTemplate="colgroup" let-columns>
        <colgroup>
          <col class="aw-table-checkbox-wrapper" />
          <col *ngFor="let col of columns" [ngStyle]="{ width: col.width }" />
        </colgroup>
      </ng-template>

      <ng-template pTemplate="header" let-columns>
        <tr>
          <th class="aw-table-checkbox-wrapper">
            <p-tableHeaderCheckbox class="aw-table-checkbox"></p-tableHeaderCheckbox>
          </th>

          <th pResizableColumn *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.alignment }">
            {{ getComponentName() + "." + col.field | translate }}
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
        <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
          <td class="aw-table-checkbox-wrapper">
            <p-tableCheckbox class="aw-table-checkbox" [value]="rowData"></p-tableCheckbox>
          </td>

          <td *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.alignment }">
            {{ rowData[col.field] }}
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <aw-dialog-line-maintenance-engine-oilreplenishment-measure
    *ngIf="dialogEngineOilReplenishmentMeasureVisible"
    [(display)]="dialogEngineOilReplenishmentMeasureVisible"
    [coldReplenishmentDate]="tableSelectedList[0].coldReplenishmentDate"
    [coldReplenishmentVolume]="tableSelectedList[0].coldReplenishmentVolume"
    [hotReplenishmentDate]="tableSelectedList[0].hotReplenishmentDate"
    [hotReplenishmentVolume]="tableSelectedList[0].hotReplenishmentVolume"
    (onValidated)="saveNewReplenishmentMeasure($event)"
  ></aw-dialog-line-maintenance-engine-oilreplenishment-measure>
</div>
