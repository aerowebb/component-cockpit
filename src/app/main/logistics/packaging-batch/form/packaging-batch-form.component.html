<div class="page-header">
  <div class="page-info">
    <div>
      <h2 class="page-title">{{ "transaction." + componentData.componentId | translate }}</h2>

      <div class="page-subtitle">
        <div *ngIf="context" class="page-subtitle">- {{ context }}</div>
      </div>
    </div>

    <!-- <div class="object-status" *ngIf="" (click)="showStatus()">
        {{  | formatSelectOption:  }}
      </div> -->
  </div>

  <div class="page-actions">
    <button *ngIf="isReadOpenMode" type="button" mat-raised-button (click)="editBatch()">
      {{ "global.edit" | translate }}
    </button>

    <button
      id="cancel"
      *ngIf="!isReadOpenMode && !isCreateOpenMode"
      color="warn"
      type="button"
      mat-raised-button
      (click)="onCancel()"
    >
      {{ "global.cancel" | translate }}
    </button>

    <button
      *ngIf="!isReadOpenMode"
      class="btn-with-spinner"
      color="primary"
      type="button"
      mat-raised-button
      (click)="saveBatch()"
    >
      <span class="lds-hourglass" *ngIf="showSaveSpinner"></span>
      {{ "global.save" | translate }}
    </button>

    <button type="button" mat-raised-button *ngIf="!isCreateOpenMode" (click)="showAddUpdatePopup()">
      {{ getComponentName() + ".delotir" | translate }}
    </button>

    <button
      mat-icon-button
      class="mat-elevation-z1"
      matTooltip="{{ 'global.showAllActionTooltip' | translate }}"
      matTooltipPosition="above"
      aria-label="Show all actions"
      [matMenuTriggerFor]="actions"
    >
      <mat-icon>more_horiz</mat-icon>
    </button>
    <mat-menu #actions="matMenu">
      <button mat-menu-item (click)="reloadBatch()">{{ "global.refresh" | translate }}</button>
      <button mat-menu-item (click)="updateFavoriteState()">{{ "addToFavorite" | translate }}</button>
    </mat-menu>
  </div>
</div>

<div class="page-wrapper">
  <div class="page-container">
    <div class="page-content">
      <mat-tab-group animationDuration="0ms" dynamicHeight>
        <!-- Home -->
        <mat-tab id="homeTab">
          <ng-template mat-tab-label>
            {{ "home" | translate }}
          </ng-template>
          <div class="grid-row">
            <!-- MAIN INFO PANEL -->
            <div class="grid-cell--12">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ "page.mainData" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content">
                  <!-- ROW 1 -->
                  <div class="row">
                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".familyVariant" | translate }}</label>

                      <div class="form-control">
                        <input
                          class="aw-input"
                          type="text"
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.familyVariantCode"
                        />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".batchNumber" | translate }}</label>

                      <div class="form-control">
                        <input
                          class="aw-input"
                          type="text"
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.batchNumber"
                        />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".pn" | translate }}</label>

                      <div class="form-control ">
                        <div *ngIf="isReadOpenMode" class="custom-anchor">
                          <a>{{ equipment.bidoEquipmentDTO.pnCode }}</a>
                        </div>
                        <div *ngIf="!isReadOpenMode">
                          <input
                            class="aw-input"
                            type="text"
                            [disabled]="isReadOpenMode"
                            [(ngModel)]="equipment.bidoEquipmentDTO.pnCode"
                          />
                        </div>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".quantity" | translate }}</label>

                      <div class="form-control">
                        <input
                          class="aw-input"
                          type="text"
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.quantity"
                        />
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".eisDate" | translate }}</label>
                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          [(ngModel)]="equipment.bidoEquipmentDTO.eisDate"
                          [disabled]="isReadOpenMode"
                        ></p-calendar>
                      </div>
                    </div>

                    <div *ngIf="!isCreateOpenMode && !isReadOpenMode" class="form-group" style="margin-top:48px">
                      <i
                        class="fa fa-fw fa-level-down aw-icon aw-icon-with-border"
                        aria-hidden="true"
                        pTooltip="{{ componentData.componentId + '.propagate' | translate }}"
                        tooltipPosition="top"
                        (click)="propagate()"
                      ></i>
                    </div>
                  </div>

                  <!-- ROW 2 -->
                  <div class="row">
                    <div class="form-group flex--2">
                      <label class="form-label">{{ getComponentName() + ".designation" | translate }}</label>

                      <div class="form-control">
                        <input
                          type="text"
                          maxlength="35"
                          class="aw-input"
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.equipmentDesignation"
                        />
                      </div>
                    </div>
                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".expirationDate" | translate }}</label>

                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          appendTo="body"
                          [(ngModel)]="mainInfo.expirationDate"
                          [disabled]="isReadOpenMode"
                        ></p-calendar>
                      </div>
                    </div>

                    <div *ngIf="!isTool() && !isAircraft()" class="form-group">
                      <label class="form-label">{{
                        componentData.componentId + ".configurationTracked" | translate
                      }}</label>

                      <div class="form-control">
                        <p-checkbox
                          class="aw-checkbox"
                          binary="true"
                          [(ngModel)]="configurationTracked"
                          [disabled]="isReadOpenMode"
                        ></p-checkbox>
                      </div>
                    </div>
                    <div *ngIf="!isTool() && isAircraft()" class="form-group">
                      <label class="form-label">{{
                        componentData.componentId + ".configurationTracked" | translate
                      }}</label>

                      <div class="form-control">
                        <p-checkbox
                          class="aw-checkbox"
                          binary="true"
                          [(ngModel)]="configurationTracked"
                          [disabled]="isReadOpenMode"
                        ></p-checkbox>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".owner" | translate }}</label>

                      <div
                        class="form-control form-control-with-modal"
                        [ngClass]="{ disabled: isReadOpenMode || !isCreateOpenMode }"
                      >
                        <div class="form-control-data" (click)="isCreateOpenMode ? searchOwners() : ''">
                          {{ equipment.bidoEquipmentDTO.ownerCustomerCode }}
                          <span *ngIf="ownerCustomerName">({{ ownerCustomerName }})</span>
                        </div>

                        <div *ngIf="equipment.bidoEquipmentDTO.ownerCustomerCode" class="btn-clear-wrapper">
                          <i
                            class="ui-dropdown-clear-icon pi pi-times aw-icon btn-clear"
                            aria-hidden="true"
                            (click)="equipment.ownerCustomerCode = undefined; ownerCustomerName = undefined"
                          ></i>
                        </div>
                        <div class="btn-search-wrapper">
                          <i
                            class="fa fa-fw fa-search aw-icon btn-search"
                            aria-hidden="true"
                            (click)="searchOwners()"
                          ></i>
                        </div>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".operator" | translate }}</label>

                      <div
                        class="form-control form-control-with-modal"
                        [ngClass]="{ disabled: isReadOpenMode || !isCreateOpenMode }"
                      >
                        <div class="form-control-data" (click)="isCreateOpenMode ? searchOperators() : ''">
                          {{ equipment.bidoEquipmentDTO.operatorCustomerCode }}
                          <span *ngIf="operatorCustomerName">({{ operatorCustomerName }})</span>
                        </div>

                        <div *ngIf="equipment.bidoEquipmentDTO.operatorCustomerCode" class="btn-clear-wrapper">
                          <i
                            class="ui-dropdown-clear-icon pi pi-times aw-icon btn-clear"
                            aria-hidden="true"
                            (click)="equipment.operatorCustomerCode = undefined; operatorCustomerName = undefined"
                          ></i>
                        </div>
                        <div class="btn-search-wrapper">
                          <i
                            class="fa fa-fw fa-search aw-icon btn-search"
                            aria-hidden="true"
                            (click)="searchOperators()"
                          ></i>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ROW 3 -->
                  <div class="row">
                    <div *ngIf="!isTool() && !isAircraft()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".manufacturer" | translate }}</label>

                      <div class="form-control">
                        <input
                          type="text"
                          maxlength="35"
                          class="aw-input"
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.snManufacturer"
                        />
                      </div>
                    </div>
                    <div *ngIf="!isTool() && isAircraft()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".acManuFacturer" | translate }}</label>

                      <div class="form-control">
                        <input
                          type="text"
                          class="aw-input "
                          [disabled]="isReadOpenMode"
                          [(ngModel)]="equipment.bidoEquipmentDTO.snManufacturer"
                        />
                      </div>
                    </div>

                    <div *ngIf="!isTool() && !isAircraft()" class="form-group general-field">
                      <label class="form-label">{{
                        componentData.componentId + ".manufacturingDate" | translate
                      }}</label>

                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          [(ngModel)]="equipment.bidoEquipmentDTO.manufacturingDate"
                          [disabled]="isReadOpenMode"
                        >
                        </p-calendar>
                      </div>
                    </div>

                    <div *ngIf="!isTool() && isAircraft()" class="form-group general-field">
                      <label class="form-label">{{
                        componentData.componentId + ".manufacturingDate" | translate
                      }}</label>

                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          [(ngModel)]="equipment.bidoEquipmentDTO.manufacturingDate"
                          [disabled]="isReadOpenMode"
                        >
                        </p-calendar>
                      </div>
                    </div>

                    <div *ngIf="!isEngine() && !isAircraft() && !isTool()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".model" | translate }}</label>

                      <div class="form-control">
                        <input type="text" class="aw-input" [disabled]="true" [(ngModel)]="equipmentModelCodeAndName" />
                      </div>
                    </div>

                    <div *ngIf="isEngine() && !isAircraft() && !isTool()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".model" | translate }}</label>

                      <div *ngIf="isCreateOpenMode" class="form-control">
                        <input type="text" class="aw-input" [(ngModel)]="equipmentModelCodeAndName" [disabled]="true" />
                      </div>

                      <div
                        *ngIf="!isCreateOpenMode"
                        class="form-control form-control-with-modal"
                        [ngClass]="{ disabled: isReadOpenMode }"
                      >
                        <div class="form-control-data" (click)="!isReadOpenMode ? searchModelCodePopup() : ''">
                          {{ equipmentModelCodeAndName }}
                        </div>
                        <div class="btn-search-wrapper">
                          <i
                            class="fa fa-fw fa-edit aw-icon btn-search"
                            aria-hidden="true"
                            (click)="searchModelCodePopup()"
                          ></i>
                        </div>
                      </div>
                    </div>

                    <div *ngIf="!isTool() && !isAircraft() && isEngine()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".manApp" | translate }}</label>

                      <div class="form-control">
                        <p-checkbox
                          class="aw-checkbox"
                          binary="true"
                          [(ngModel)]="equipment.pMa"
                          [disabled]="isReadOpenMode"
                        ></p-checkbox>
                      </div>
                    </div>

                    <div *ngIf="!isEngine() && !isAircraft() && !isTool()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".rating" | translate }}</label>

                      <div class="form-control">
                        <input
                          type="text"
                          class="aw-input"
                          [disabled]="true"
                          [(ngModel)]="equipmentRatingCodeAndName"
                        />
                      </div>
                    </div>

                    <div *ngIf="isEngine() && !isAircraft() && !isTool()" class="form-group">
                      <label class="form-label">{{ componentData.componentId + ".rating" | translate }}</label>

                      <div *ngIf="isCreateOpenMode" class="form-control">
                        <input
                          type="text"
                          class="aw-input"
                          [(ngModel)]="equipmentRatingCodeAndName"
                          [disabled]="true"
                        />
                      </div>

                      <div
                        *ngIf="!isCreateOpenMode"
                        class="form-control form-control-with-modal"
                        [ngClass]="{ disabled: isReadOpenMode }"
                      >
                        <div class="form-control-data" (click)="!isReadOpenMode ? searchRatingCodePopup() : ''">
                          {{ equipmentRatingCodeAndName }}
                        </div>
                        <div class="btn-search-wrapper">
                          <i
                            class="fa fa-fw fa-edit aw-icon btn-search"
                            aria-hidden="true"
                            (click)="searchRatingCodePopup()"
                          ></i>
                        </div>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">{{ getComponentName() + ".operationalStatus" | translate }}</label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          placeholder="&nbsp;"
                          [showClear]="true"
                          [(ngModel)]="equipment.bidoEquipmentDTO.operationalStatus"
                          [options]="statusList"
                          [disabled]="isReadOpenMode"
                        ></p-dropdown>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Engineering References -->
            <div class="grid-cell--12">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ componentData.componentId + ".engineeringReferences" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content  grid-cell-content-with-section">
                  <div class="row">
                    <div *ngIf="!isTool()" class="section">
                      <div *ngIf="!isAircraft()" class="section-content">
                        <div class="column">
                          <div class="row">
                            <div class="form-group">
                              <label class="form-label">{{
                                componentData.componentId + ".itemCode" | translate
                              }}</label>
                              <div class="form-control display--flex-row">
                                <input
                                  type="text"
                                  class="aw-input flex--1"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.chapter"
                                  maxlength="2"
                                />
                                <span style="margin-top:10px" class="separator">-</span>
                                <input
                                  type="text"
                                  class="aw-input flex--1"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.section"
                                  maxlength="2"
                                />
                                <span style="margin-top:10px" class="separator">-</span>
                                <input
                                  type="text"
                                  class="aw-input flex--1"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.subject"
                                  maxlength="2"
                                />
                                <span style="margin-top:10px" class="separator">-</span>
                                <input
                                  type="text"
                                  class="aw-input flex--1"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.sheet"
                                  maxlength="5"
                                />
                                <span style="margin-top:10px" class="separator">-</span>
                                <input
                                  type="text"
                                  class="aw-input flex--1"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.marks"
                                  maxlength="5"
                                />

                                <div class="btn-search-wrapper" *ngIf="!isReadOpenMode">
                                  <i
                                    class="fa fa-fw fa-search aw-icon btn-search"
                                    aria-hidden="true"
                                    (click)="openItemTableDialog()"
                                  ></i>
                                </div>
                              </div>
                            </div>

                            <div class="form-group general-field">
                              <label class="form-label">{{
                                componentData.componentId + ".itemNumber" | translate
                              }}</label>

                              <div class="form-control">
                                <input
                                  type="text"
                                  class="aw-input"
                                  [(ngModel)]="equipment.itemNumber"
                                  [disabled]="isReadOpenMode"
                                />
                              </div>
                            </div>

                            <div class="form-group general-field">
                              <label class="form-label">{{
                                componentData.componentId + ".functionCode" | translate
                              }}</label>

                              <div class="form-control">
                                <input
                                  type="text"
                                  class="aw-input"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.functionCode"
                                  [disabled]="isReadOpenMode"
                                />
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="form-label">{{
                                componentData.componentId + ".position" | translate
                              }}</label>

                              <div class="form-control">
                                <p-dropdown
                                  class="aw-dropdown fixed-width"
                                  [options]="propertyPositions"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.equiPosition"
                                  [showClear]="true"
                                  placeholder="&nbsp;"
                                  [disabled]="isReadOpenMode"
                                ></p-dropdown>
                              </div>
                            </div>
                            <div *ngIf="!isEngine()" class="form-group">
                              <label class="form-label">{{
                                componentData.componentId + ".function" | translate
                              }}</label>
                              <div class="form-control">
                                <p-dropdown
                                  class="aw-dropdown fixed-width"
                                  [options]="propertyFunctions"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.equipmentFunction"
                                  [showClear]="true"
                                  placeholder="&nbsp;"
                                  [disabled]="isReadOpenMode"
                                ></p-dropdown>
                              </div>
                            </div>
                            <div *ngIf="!isEngine()" class="form-group">
                              <label class="form-label">{{
                                componentData.componentId + ".lifeRestriction" | translate
                              }}</label>

                              <div class="form-control">
                                <p-checkbox
                                  class="aw-checkbox"
                                  binary="true"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.lifeRestriction"
                                  [disabled]="isReadOpenMode"
                                >
                                </p-checkbox>
                              </div>
                            </div>
                            <div *ngIf="!isEngine()" class="form-group general-field">
                              <label class="form-label">{{
                                componentData.componentId + ".manufacturingConfiguration" | translate
                              }}</label>

                              <div class="form-control">
                                <p-checkbox
                                  binary="true"
                                  class="aw-checkbox"
                                  [(ngModel)]="equipment.bidoEquipmentDTO.manufacturingConfiguration"
                                  [disabled]="isReadOpenMode"
                                ></p-checkbox>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-cell--6">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ componentData.componentId + ".geographicalLocation" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content  grid-cell-content-with-section">
                  <div class="section">
                    <div class="section-content">
                      <div class="row">
                        <div class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".zone" | translate }}</label>

                          <div *ngIf="isCreateOpenMode" class="form-control">
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              [options]="propertyZones"
                              [(ngModel)]="equipment.bidoEquipmentDTO.zone"
                              (onChange)="changeZone()"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>

                          <div
                            *ngIf="!isCreateOpenMode"
                            class="form-control form-control-with-modal"
                            [ngClass]="{ disabled: isReadOpenMode }"
                          >
                            <div class="form-control-data" (click)="!isReadOpenMode ? searchGeoLocation() : ''">
                              {{ equipment.bidoEquipmentDTO.zone }}
                            </div>
                            <div *ngIf="equipment.bidoEquipmentDTO.zone" class="btn-clear-wrapper">
                              <i
                                class="ui-dropdown-clear-icon pi pi-times aw-icon btn-clear"
                                aria-hidden="true"
                                (click)="equipment.bidoEquipmentDTO.zone = undefined"
                              ></i>
                            </div>
                            <div class="btn-search-wrapper">
                              <i
                                class="fa fa-fw fa-edit aw-icon btn-search"
                                aria-hidden="true"
                                (click)="searchGeoLocation()"
                              ></i>
                            </div>
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".country" | translate }}</label>

                          <div *ngIf="isCreateOpenMode" class="form-control">
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              [options]="propertyCountries"
                              [(ngModel)]="equipment.bidoEquipmentDTO.country"
                              (onChange)="changeCountry()"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                          <div *ngIf="!isCreateOpenMode" class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [disabled]="isReadOpenMode"
                              [(ngModel)]="equipment.bidoEquipmentDTO.country"
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".location" | translate }}</label>

                          <div class="form-control">
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              [options]="propertyLocations"
                              [(ngModel)]="locationValue"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-cell--6">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ componentData.componentId + ".usCounters" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content  grid-cell-content-with-section">
                  <div class="section">
                    <div class="section-content">
                      <div class="row">
                        <div class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".usage" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="
                              !equipment.usageCounterCalculationDTO.usageValue ||
                              equipment.usageCounterCalculationDTO.usageValue === NOT_ACTIVATED
                                ? COLOR_RED
                                : COLOR_GREEN
                            "
                          >
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="equipment.usageCounterCalculationDTO.usageValue"
                              [disabled]="isReadOpenMode"
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".storage" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="
                              !equipment.usageCounterCalculationDTO.storageValue ||
                              equipment.usageCounterCalculationDTO.storageValue === NOT_ACTIVATED
                                ? COLOR_RED
                                : COLOR_GREEN
                            "
                          >
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="equipment.usageCounterCalculationDTO.storageValue"
                              [disabled]="isReadOpenMode"
                            />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">{{
                            componentData.componentId + ".usageStorage" | translate
                          }}</label>

                          <div
                            class="form-control"
                            [ngClass]="
                              !equipment.usageCounterCalculationDTO.usageStorageValue ||
                              equipment.usageCounterCalculationDTO.usageStorageValue === NOT_ACTIVATED
                                ? COLOR_RED
                                : COLOR_GREEN
                            "
                          >
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="equipment.usageCounterCalculationDTO.usageStorageValue"
                              [disabled]="isReadOpenMode"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="!isCreateOpenMode" id="structureTab">
          <ng-template mat-tab-label>
            {{ componentData.componentId + ".batchInfo" | translate }}
          </ng-template>
          <div class="grid-row">
            <!-- Batch Reference -->
            <div class="grid-cell--12">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ getComponentName() + ".batchReference" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content  grid-cell-content-with-section">
                  <div class="column">
                    <div class="row">
                      <!-- SECTION  1 -->
                      <div class="section flex--2">
                        <h4 class="section-title">
                          {{ componentData.componentId + ".manufaturingBatch" | translate }}
                        </h4>
                        <div class="section-content">
                          <div class="row">
                            <div class="form-group">
                              <label class="form-label">{{
                                getComponentName() + ".manufaturingBatchNumber" | translate
                              }}</label>

                              <div class="form-control ">
                                <div *ngIf="isReadOpenMode" class="custom-anchor">
                                  <a (click)="openMfgBatch(equipment.manufacturingBatch.equipmentCode)">{{
                                    equipment.manufacturingBatch && equipment.manufacturingBatch.batchNumber
                                  }}</a>
                                </div>
                                <div *ngIf="!isReadOpenMode">
                                  <input
                                    class="aw-input"
                                    type="text"
                                    [disabled]="isReadOpenMode"
                                    [(ngModel)]="
                                      equipment.manufacturingBatch && equipment.manufacturingBatch.batchNumber
                                    "
                                  />
                                </div>
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="form-label">{{ getComponentName() + ".batchQuantity" | translate }}</label>

                              <div class="form-control">
                                <input
                                  class="aw-input"
                                  type="text"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="equipment.manufacturingBatch && equipment.manufacturingBatch.quantity"
                                />
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="form-label">{{
                                getComponentName() + ".manufaturingBatchDate" | translate
                              }}</label>

                              <div class="form-control">
                                <p-calendar
                                  showButtonBar="true"
                                  [monthNavigator]="true"
                                  [yearNavigator]="true"
                                  [yearRange]="sessionService.calendarYearRange"
                                  class="aw-calendar"
                                  [dateFormat]="sessionService.dateFormatPrimeNG"
                                  [locale]="sessionService.calendarFormat"
                                  appendTo="body"
                                  [(ngModel)]="equipment.manufacturingBatch && equipment.manufacturingBatch.date"
                                  [disabled]="isReadOpenMode"
                                ></p-calendar>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- SECTION 2 -->
                      <div class="section flex--2">
                        <h4 class="section-title">
                          {{ componentData.componentId + ".originalPackagingBatch" | translate }}
                        </h4>
                        <div class="section-content">
                          <div class="row">
                            <div class="form-group">
                              <label class="form-label">{{
                                getComponentName() + ".originalPackagingBatchNumber" | translate
                              }}</label>

                              <div class="form-control ">
                                <div *ngIf="isReadOpenMode" class="custom-anchor">
                                  <a (click)="openPackagingBatch(equipment.superiorPackagingBatch.equipmentCode)">{{
                                    equipment.superiorPackagingBatch && equipment.superiorPackagingBatch.batchNumber
                                  }}</a>
                                </div>
                                <div *ngIf="!isReadOpenMode">
                                  <input
                                    class="aw-input"
                                    type="text"
                                    [disabled]="isReadOpenMode"
                                    [(ngModel)]="
                                      equipment.superiorPackagingBatch && equipment.superiorPackagingBatch.batchNumber
                                    "
                                  />
                                </div>
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="form-label">{{
                                getComponentName() + ".originalPackagingBatchQuantity" | translate
                              }}</label>

                              <div class="form-control">
                                <input
                                  class="aw-input"
                                  type="text"
                                  [disabled]="isReadOpenMode"
                                  [(ngModel)]="
                                    equipment.superiorPackagingBatch && equipment.superiorPackagingBatch.quantity
                                  "
                                />
                              </div>
                            </div>
                            <div class="form-group">
                              <label class="form-label">{{
                                getComponentName() + ".originalPackagingBatchDate" | translate
                              }}</label>

                              <div class="form-control">
                                <p-calendar
                                  showButtonBar="true"
                                  [monthNavigator]="true"
                                  [yearNavigator]="true"
                                  [yearRange]="sessionService.calendarYearRange"
                                  class="aw-calendar"
                                  [dateFormat]="sessionService.dateFormatPrimeNG"
                                  [locale]="sessionService.calendarFormat"
                                  appendTo="body"
                                  [(ngModel)]="
                                    equipment.superiorPackagingBatch && equipment.superiorPackagingBatch.date
                                  "
                                  [disabled]="isReadOpenMode"
                                ></p-calendar>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Sub Assemblies -->
            <div *ngIf="!isCreateOpenMode">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ getComponentName() + ".subAssemblies" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content">
                    <p-table
                      [resizableColumns]="true"
                      #pSubAssemblyPosts
                      class="aw-table2"
                      [columns]="subAssemblyTableCols"
                      [value]="subAssemblyTableData"
                      [scrollable]="true"
                    >
                      <ng-template pTemplate="emptymessage">
                        <span *ngIf="!isLoadingEventsTable"> &nbsp;</span>

                        <div *ngIf="isLoadingEventsTable" class="aw-table-loading-indicator">
                          <div class="loading-message">{{ "table.loadingData" | translate }}</div>
                          <div class="lds-hourglass"></div>
                        </div>
                      </ng-template>

                      <ng-template pTemplate="caption">
                        <div class="aw-table-header">
                          <div class="aw-table-global-filter">
                            <label class="aw-table-global-filter-label">
                              <i class="fa fa-fw fa-search" aria-hidden="true"></i>
                            </label>

                            <input
                              #ptableMeasuresGlobalFilter
                              class="aw-table-global-filter-input"
                              type="text"
                              placeholder="{{ 'table.globalFilterText' | translate }}"
                              (input)="pSubAssemblyPosts.filterGlobal($event.target.value, 'contains')"
                            />
                          </div>
                        </div>
                      </ng-template>

                      <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                          <col *ngFor="let col of columns" [ngStyle]="{ width: col.width }" />
                        </colgroup>
                      </ng-template>

                      <ng-template pTemplate="header" let-columns>
                        <tr>
                          <th pResizableColumn *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.alignment }">
                            {{ componentData.componentId + "." + col.field | translate }}
                          </th>
                        </tr>
                      </ng-template>

                      <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
                        <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
                          <td
                            *ngFor="let col of columns"
                            [ngSwitch]="col.field"
                            [ngStyle]="{ 'text-align': col.alignment }"
                          >
                            <span *ngSwitchCase="'batchNumber'">
                              <a (click)="openPackagingBatch(rowData.equipmentCode)">{{ rowData[col.field] }}</a>
                            </span>
                            <span *ngSwitchCase="'creationDate'">
                              {{ rowData[col.field] | date: "shortDate":"":translateService.currentLang }}
                            </span>
                            <span *ngSwitchCase="'operationalStatus'">{{
                              rowData[col.field] | formatSelectOption: statusList
                            }}</span>
                            <span *ngSwitchCase="'emp'">
                              {{ rowData["location"] }}
                            </span>
                            <span *ngSwitchCase="'quantity'">
                              {{ rowData[col.field] | formatNumber }}
                            </span>
                            <span *ngSwitchCase="'batchOriginQty'">
                              {{ rowData[col.field] | formatNumber }}
                            </span>
                            <span *ngSwitchDefault>
                              {{ rowData[col.field] }}
                            </span>
                          </td>
                        </tr>
                      </ng-template>
                    </p-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="!isCreateOpenMode" id="stockTab">
          <ng-template mat-tab-label>
            {{ componentData.componentId + ".stock" | translate }}
          </ng-template>
          <!-- Stock -->
          <div class="grid-row">
            <div *ngIf="!isCreateOpenMode">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ componentData.componentId + ".currentStock" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content grid-cell-content-with-section">
                    <div *ngIf="!isReadOpenMode && !isCreateOpenMode" class="grid-cell-content-action">
                      <button type="button" mat-raised-button (click)="createStockMovement()">
                        {{ componentData.componentId + ".createStockMovement" | translate }}
                      </button>
                    </div>

                    <div class="section">
                      <div class="section-content">
                        <div class="row">
                          <div class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".site" | translate }}</label>

                            <div class="form-control">
                              <input
                                type="text"
                                class="aw-input"
                                [(ngModel)]="equipment.stockOutputDto.site"
                                [disabled]="true"
                              />
                            </div>
                          </div>

                          <div class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".warehouse" | translate }}</label>

                            <div class="form-control">
                              <input
                                type="text"
                                class="aw-input"
                                [(ngModel)]="equipment.stockOutputDto.warehouse"
                                [disabled]="true"
                              />
                            </div>
                          </div>

                          <div class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".zone" | translate }}</label>

                            <div class="form-control">
                              <input type="text" class="aw-input" [(ngModel)]="areaText" [disabled]="true" />
                            </div>
                          </div>

                          <div class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".bin" | translate }}</label>

                            <div class="form-control">
                              <input
                                type="text"
                                class="aw-input"
                                [(ngModel)]="equipment.stockOutputDto.storageBin"
                                [disabled]="true"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 *ngIf="!awPropertiesConstants.MM_FULL_MODULE_ACTIVATED" class="grid-cell-title">
                        {{ componentData.componentId + ".stockLog" | translate }} ({{
                          bidoStockDisplayed ? bidoStockDisplayed.length : 0
                        }})
                      </h3>
                      <h3 *ngIf="awPropertiesConstants.MM_FULL_MODULE_ACTIVATED" class="grid-cell-title">
                        {{ componentData.componentId + ".stockLog" | translate }} ({{
                          stockMvtTableDataSource.dataCount
                        }})
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content grid-cell-content-with-section">
                    <div class="section" *ngIf="!awPropertiesConstants.MM_FULL_MODULE_ACTIVATED">
                      <div class="section-content">
                        <div class="row">
                          <div class="table-wrapper">
                            <p-table
                              [resizableColumns]="true"
                              #ptableStock
                              class="aw-table2"
                              [columns]="stockTableCols"
                              [value]="bidoStockDisplayed"
                              [scrollable]="true"
                              dataKey="code"
                              [paginator]="true"
                              [rows]="TABLE_PAGINATION_DEFAULT_ROWS"
                            >
                              <ng-template pTemplate="emptymessage">
                                <span *ngIf="!isLoadingStockTable"> &nbsp;</span>

                                <div *ngIf="isLoadingStockTable" class="aw-table-loading-indicator">
                                  <div class="loading-message">{{ "table.loadingData" | translate }}</div>
                                  <div class="lds-hourglass"></div>
                                </div>
                              </ng-template>

                              <ng-template pTemplate="caption">
                                <div class="aw-table-header">
                                  <div class="aw-table-global-filter">
                                    <label class="aw-table-global-filter-label">
                                      <i class="fa fa-fw fa-search" aria-hidden="true"></i>
                                    </label>

                                    <input
                                      #ptableStockGlobalFilter
                                      class="aw-table-global-filter-input"
                                      type="text"
                                      placeholder="{{ 'table.globalFilterText' | translate }}"
                                      (input)="ptableStock.filterGlobal($event.target.value, 'contains')"
                                    />
                                  </div>

                                  <div class="aw-table-actions"></div>
                                </div>
                              </ng-template>

                              <ng-template pTemplate="colgroup" let-columns>
                                <colgroup>
                                  <col
                                    *ngFor="let col of columns"
                                    [ngStyle]="{ width: col.width, 'text-align': col.alignment }"
                                  />
                                  <col class="row-expand-wrapper" />
                                  <col class="row-action-wrapper" />
                                </colgroup>
                              </ng-template>

                              <ng-template pTemplate="header" let-columns>
                                <tr>
                                  <th
                                    pResizableColumn
                                    *ngFor="let col of columns"
                                    [ngStyle]="{ width: col.width, 'text-align': col.alignment }"
                                  >
                                    {{ componentData.componentId + "." + col.field | translate }}
                                  </th>
                                  <th class="row-expand-wrapper"></th>
                                  <th class="row-action-wrapper"></th>
                                </tr>
                              </ng-template>

                              <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
                                <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
                                  <td
                                    *ngFor="let col of columns"
                                    [ngSwitch]="col.field"
                                    [ngStyle]="{ width: col.width, 'text-align': col.alignment }"
                                  >
                                    <span *ngSwitchCase="'stockMvtDate'">
                                      {{ rowData[col.field] | date: "shortDate":"":translateService.currentLang }}
                                    </span>
                                    <span *ngSwitchCase="'code'">
                                      {{ rowData["code"] }}
                                    </span>

                                    <span *ngSwitchCase="'document'">
                                      <a *ngIf="rowData['document']" (click)="onClickDocument(rowData)">
                                        {{ rowData["document"] }}</a
                                      >
                                    </span>
                                    <span *ngSwitchDefault>{{ rowData[col.field] }}</span>
                                  </td>

                                  <td class="row-expand-wrapper" [pRowToggler]="rowData">
                                    <i
                                      class="fa fa-fw aw-icon aw-icon-with-border"
                                      [ngClass]="rowData._expand ? 'fa-minus' : 'fa-plus'"
                                      aria-hidden="true"
                                      pTooltip="{{ 'global.showTableRowDetails' | translate }}"
                                      tooltipPosition="top"
                                      (click)="toggleRowDetailsVisibilityStock(rowData)"
                                    ></i>
                                  </td>
                                </tr>
                              </ng-template>

                              <ng-template pTemplate="rowexpansion" let-rowData let-columns="columns">
                                <tr class="row-expanded" *ngIf="rowData._expand">
                                  <td [attr.colspan]="columns.length + 2">
                                    <div class="row">
                                      <div class="form-group">
                                        <label class="form-label">
                                          {{ getComponentName() + ".stockMvtBatchNumber" | translate }}
                                        </label>

                                        <div class="form-control">
                                          <input
                                            class="aw-input"
                                            type="text"
                                            [(ngModel)]="rowData.stockMvtBatchNumber"
                                            [disabled]="true"
                                          />
                                        </div>
                                      </div>
                                      <div class="form-group">
                                        <label class="form-label">
                                          {{ getComponentName() + ".bin" | translate }}
                                        </label>
                                        <div class="form-control">
                                          <input
                                            class="aw-input"
                                            type="text"
                                            [(ngModel)]="rowData.bin"
                                            [disabled]="true"
                                          />
                                        </div>
                                      </div>
                                      <div class="form-group">
                                        <label class="form-label">
                                          {{ getComponentName() + ".stockType" | translate }}
                                        </label>

                                        <div class="form-control">
                                          <input
                                            class="aw-input"
                                            type="text"
                                            [(ngModel)]="rowData.stockType"
                                            [disabled]="true"
                                          />
                                        </div>
                                      </div>
                                      <div class="form-group">
                                        <label class="form-label">
                                          {{ getComponentName() + ".valuation" | translate }}
                                        </label>

                                        <div class="form-control">
                                          <input
                                            class="aw-input"
                                            type="text"
                                            [(ngModel)]="rowData.valuation"
                                            [disabled]="true"
                                          />
                                        </div>
                                      </div>
                                      <div class="form-group">
                                        <label class="form-label">
                                          {{ getComponentName() + ".comments" | translate }}
                                        </label>

                                        <div class="form-control">
                                          <input
                                            class="aw-input"
                                            type="text"
                                            [(ngModel)]="rowData.comments"
                                            [disabled]="true"
                                          />
                                        </div>
                                      </div>
                                    </div>
                                  </td>
                                </tr>
                              </ng-template>
                            </p-table>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="section" *ngIf="awPropertiesConstants.MM_FULL_MODULE_ACTIVATED">
                      <div class="section-content">
                        <div class="row">
                          <div class="table-wrapper">
                            <a-table [dataSource]="stockMvtTableDataSource">
                              <ng-template columnDef="movement" let-rowData="rowData">
                                <div>
                                  <a style="font-weight: 600;" (click)="openStockMovement(rowData)">
                                    {{ rowData["stockMvtCode"] }}
                                  </a>
                                </div>

                                <div>
                                  {{ rowData["bidtStockMvtType"]?.smtName | extractTranslation }}
                                </div>
                              </ng-template>

                              <ng-template columnDef="type" let-rowData="rowData">
                                <i
                                  *ngIf="rowData['bidtStockMvtType']?.smtWay === bidtStockMvtConstants.MVT_WAY_CREDIT"
                                  class="fa fa-fw fa-arrow-right procurement-type--in"
                                  aria-hidden="true"
                                ></i>
                                <i
                                  *ngIf="rowData['bidtStockMvtType']?.smtWay === bidtStockMvtConstants.MVT_WAY_DEBIT"
                                  class="fa fa-fw fa-arrow-right procurement-type--out"
                                  aria-hidden="true"
                                ></i>
                                <i
                                  *ngIf="rowData['bidtStockMvtType']?.smtWay === bidtStockMvtConstants.MVT_WAY_TRANSFER"
                                  class="fa fa-fw fa-arrow-right procurement-type--transfer"
                                  aria-hidden="true"
                                ></i>
                              </ng-template>

                              <ng-template columnDef="warehouseWorkshop" let-rowData="rowData">
                                <div>
                                  <div style="min-width: 3rem; display: inline-block;">
                                    {{ getComponentName() + ".site" | translate }}
                                  </div>
                                  <span style="font-weight: 600">{{ rowData["siteName"] }}</span>
                                </div>
                                <div>
                                  <span style="font-weight: 600">{{ rowData["warehousename"] }}</span>
                                </div>
                              </ng-template>

                              <ng-template columnDef="outbound" let-rowData="rowData">
                                <div *ngIf="rowData['bidtStorageBinZoneIssue']?.sbNumber">
                                  <div style="min-width: 2rem; display: inline-block;">
                                    {{ getComponentName() + ".zone" | translate }}
                                  </div>
                                  <span style="font-weight: 600">
                                    {{ rowData["bidtStorageBinZoneIssue"]?.sbNumber }}
                                    <ng-container *ngIf="rowData['bidtStorageBinZoneIssue']?.sbDescription">
                                      - {{ rowData["bidtStorageBinZoneIssue"]?.sbDescription }}
                                    </ng-container>
                                  </span>
                                </div>

                                <div *ngIf="rowData['bidtStorageBinBinIssue']?.sbNumber">
                                  <div style="min-width: 3rem; display: inline-block;">
                                    {{ getComponentName() + ".emp" | translate }}
                                  </div>
                                  <span style="font-weight: 600">{{
                                    rowData["bidtStorageBinBinIssue"]?.sbNumber
                                  }}</span>
                                </div>
                              </ng-template>

                              <ng-template columnDef="inbound" let-rowData="rowData">
                                <div *ngIf="rowData['bidtStorageBinZoneReceipt']?.sbNumber">
                                  <div style="min-width: 2rem; display: inline-block;">
                                    {{ getComponentName() + ".zone" | translate }}
                                  </div>
                                  <span style="font-weight: 600">
                                    {{ rowData["bidtStorageBinZoneReceipt"]?.sbNumber }}
                                    <ng-container *ngIf="rowData['bidtStorageBinZoneReceipt']?.sbDescription">
                                      - {{ rowData["bidtStorageBinZoneReceipt"]?.sbDescription }}
                                    </ng-container>
                                  </span>
                                </div>

                                <div *ngIf="rowData['bidtStorageBinBinReceipt']?.sbNumber">
                                  <div style="min-width: 3rem; display: inline-block;">
                                    {{ getComponentName() + ".emp" | translate }}
                                  </div>
                                  <span style="font-weight: 600">{{
                                    rowData["bidtStorageBinBinReceipt"]?.sbNumber
                                  }}</span>
                                </div>
                              </ng-template>

                              <ng-template columnDef="status" let-rowData="rowData">
                                <div>
                                  <span style="font-weight: 600;">{{ rowData["smoStatus"].label }}</span>
                                </div>

                                <div>
                                  {{
                                    (rowData["_stockMvt"].stockMvtDate
                                      ? rowData["_stockMvt"].stockMvtDate
                                      : rowData["_stockMvt"].stockMvtPlannedDate
                                    ) | date: "yyyy/MM/dd HH:mm":"":translateService.currentLang
                                  }}
                                </div>
                              </ng-template>

                              <ng-template columnDef="document" let-rowData="rowData">
                                <div>
                                  <a (click)="openDocOrigine(rowData)">{{ rowData["documentNum"] }}</a>
                                </div>
                                <div>
                                  <i>{{ rowData["documentDescription"] }}</i>
                                </div>
                              </ng-template>
                            </a-table>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!--------table end ---------->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="!isCreateOpenMode" id="additionalTab">
          <ng-template mat-tab-label>
            {{ getComponentName() + ".additionalInfo" | translate }}
          </ng-template>
          <div class="grid-row">
            <!-- Additional Information -->
            <div class="grid-cell--12">
              <div class="grid-cell grid-cell--container">
                <div class="grid-cell-header">
                  <div class="grid-cell-title-container">
                    <h3 class="grid-cell-title">
                      {{ getComponentName() + ".additionalInfo" | translate }}
                    </h3>
                  </div>
                </div>

                <div class="grid-cell-content grid-cell-content-with-section">
                  <div *ngIf="!isTool()" class="section">
                    <div class="section-content">
                      <div class="column">
                        <div class="row">
                          <div *ngIf="!isAircraft()" class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".assetCode" | translate }}</label>

                            <div class="form-control">
                              <input
                                type="text"
                                maxlength="25"
                                class="aw-input"
                                [(ngModel)]="equipment.bidoEquipmentDTO.equipmentCode"
                                [disabled]="isReadOpenMode"
                              />
                            </div>
                          </div>
                          <div *ngIf="isAircraft()" class="form-group">
                            <label class="form-label">{{ componentData.componentId + ".assetCode" | translate }}</label>

                            <div class="form-control">
                              <input
                                type="text"
                                maxlength="25"
                                class="aw-input"
                                [(ngModel)]="equipment.bidoEquipmentDTO.equipmentCode"
                                [disabled]="isReadOpenMode"
                              />
                            </div>
                          </div>
                        </div>

                        <aw-dynamic-attributes
                          [showHistory]="true"
                          [history]="dynamicAttributesHistoric"
                          [attributes]="dynamicAttributes"
                          [isReadOpenMode]="isReadOpenMode"
                        >
                        </aw-dynamic-attributes>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
        <mat-tab *ngIf="!isCreateOpenMode" id="documentTab">
          <ng-template mat-tab-label>
            {{ componentData.componentId + ".tabDocument" | translate }}
          </ng-template>
          <div class="grid-row">
            <!-- Documents -->
            <div *ngIf="!isCreateOpenMode">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ componentData.componentId + ".tabDocument" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content">
                    <a-table [dataSource]="documentTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="documentTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="downloadFiles()"
                        >
                          {{ "global.download" | translate }}
                        </button>
                        <button
                          *ngIf="!isReadOpenMode && documentTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteDocuments()"
                        >
                          {{ "global.delete" | translate }}
                        </button>
                        <button
                          *ngIf="!isReadOpenMode && documentTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="editDocument()"
                        >
                          {{ "global.edit" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && documentTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openDocument()"
                        >
                          {{ "global.open" | translate }}
                        </button>
                        <p-fileUpload
                          #fileUploader
                          *ngIf="!isReadOpenMode && !documentTableDataSource.hasDataSelection"
                          chooseLabel="{{ 'global.upload' | translate }}"
                          name="document[]"
                          customUpload="true"
                          mode="basic"
                          auto="true"
                          (uploadHandler)="uploadDocument($event, fileUploader)"
                        ></p-fileUpload>
                      </ng-template>
                      <ng-template columnDef="docEndOfValidityDate" let-rowData="rowData">
                        {{ rowData.docEndOfValidityDate | date: "shortDate":"":translateService.currentLang }}
                      </ng-template>
                      <ng-template columnDef="docExtension" let-rowData="rowData">
                        <span> {{ showDocExtension(rowData) }} </span>
                      </ng-template>
                      <ng-template columnDef="docPublicationDate" let-rowData="rowData">
                        <span>
                          {{ rowData.docPublicationDate | date: "shortDate":"":translateService.currentLang }}
                        </span>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

<aw-dialog-table
  *ngIf="showDialogOwner"
  [(display)]="showDialogOwner"
  [data]="dialogTableDataOwner"
  (onSelected)="setSelectedOwner($event)"
></aw-dialog-table>

<aw-dialog-table
  *ngIf="showDialogOperator"
  [(display)]="showDialogOperator"
  [data]="dialogTableDataOperator"
  (onSelected)="setSelectedOperator($event)"
></aw-dialog-table>

<aw-dialog-table
  *ngIf="showItemTableDialog"
  [keyMap]="keyMap"
  [data]="itemTableData"
  [(display)]="showItemTableDialog"
  (onSelected)="setSelectedItems($event)"
></aw-dialog-table>

<aw-dialog-add-update
  *ngIf="openAddUpdatedialog"
  [(display)]="openAddUpdatedialog"
  [subAssemblyObject]="subAssemblyPopupObject"
  [quantity]="equipment.bidoEquipmentDTO.quantity"
  [operatonalStatus]="equipment.bidoEquipmentDTO.operationalStatus"
  [unit]="packagingBatchUnit"
  (onValidate)="updateSubAssembly($event)"
>
</aw-dialog-add-update>

<aw-document-upload-dialog
  *ngIf="showAddDocumentDialog"
  [(display)]="showAddDocumentDialog"
  [openMode]="documentDialogOpenMode"
  [document]="currentDocument"
  [types]="documentTypes"
  (onValidated)="addNewDocument($event)"
>
</aw-document-upload-dialog>
