<div class="page-header">
  <div class="page-info">
    <div>
      <div class="page-title">
        {{ "transaction." + componentData.componentId | translate }}
      </div>

      <div class="page-subtitle">
        <div class="page-subtitle">- {{ "global.search" | translate }}</div>
      </div>
    </div>
  </div>

  <div class="page-actions">
    <button type="button" mat-raised-button (click)="openNewEvent()" *ngIf="hasUpdateAccessRight">
      {{ "global.create" | translate }}
    </button>
    <button
      id="actions"
      mat-icon-button
      class="mat-elevation-z1"
      matTooltip="{{ 'global.showAllActionTooltip' | translate }}"
      matTooltipPosition="above"
      aria-label="Show All Actions"
      [matMenuTriggerFor]="actions"
    >
      <mat-icon>more_horiz</mat-icon>
    </button>

    <mat-menu #actions="matMenu">
      <button id="favorites" mat-menu-item (click)="updateFavoriteState()">
        {{ (isFavoriteEntry ? "page.removeFromFavorites" : "page.addToFavorites") | translate }}
      </button>
    </mat-menu>
  </div>
</div>

<div class="page-wrapper">
  <div class="page-container search-page-container">
    <div class="page-content">
      <div class="grid-row">
        <div class="grid-cell--12">
          <div class="grid-cell grid-cell--container" style="height: auto;">
            <div class="grid-cell-header">
              <div class="grid-cell-title-container">
                <h3 class="grid-cell-title">{{ "global.search" | translate }}</h3>
              </div>
            </div>

            <div class="grid-cell-content grid-cell-content-with-section">
              <div class="section">
                <div class="section-content">
                  <div class="row search-criteria-header">
                    <aw-manage-search-criteria
                      [componentId]="SEARCH_CRITERIA_ID"
                      (onSelected)="loadSearchCriteria($event)"
                      (onSavedAsked)="saveSearchCriteriaAsked()"
                      [objectFromPage]="criteriaToSave"
                    ></aw-manage-search-criteria>
                  </div>
                </div>
              </div>

              <div class="section">
                <h4 class="section-title">1. {{ componentData.componentId + ".assetCriteria" | translate }}</h4>

                <div class="section-content">
                  <div class="row">
                    <div class="form-group flex--2">
                      <label class="form-label"> &nbsp; </label>

                      <div class="form-control aw-selectbutton-wrapper">
                        <p-selectButton
                          [(ngModel)]="selectedSearchAsset"
                          [options]="searchAssetList"
                          (onChange)="onChangeSearchAsset()"
                        ></p-selectButton>
                      </div>
                    </div>
                    <div class="form-group"></div>
                  </div>
                  <div class="row">
                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".familyVariant" | translate }} </label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          placeholder="&nbsp;"
                          [showClear]="true"
                          [options]="familyVariantList"
                          [(ngModel)]="selectedFamilyVariant"
                          (keyup.enter)="search()"
                          appendTo="body"
                        ></p-dropdown>
                      </div>
                    </div>
                    <div
                      class="form-group"
                      *ngIf="
                        selectedSearchAsset === searchAsset.Equipment ||
                        selectedSearchAsset === searchAsset.GroundEquipment
                      "
                    >
                      <label class="form-label"> {{ componentData.componentId + ".designation" | translate }} </label>

                      <div class="form-control">
                        <input type="text" [(ngModel)]="equipmentDesignation" class="aw-input" />
                      </div>
                    </div>
                    <div class="form-group" *ngIf="selectedSearchAsset !== searchAsset.Equipment"></div>
                    <div class="form-group" *ngIf="selectedSearchAsset !== searchAsset.GroundEquipment"></div>
                    <div class="form-group"></div>
                  </div>
                  <div class="row">
                    <div
                      class="form-group"
                      [ngClass]="{
                        'display--none':
                          selectedSearchAsset === searchAsset.All ||
                          selectedSearchAsset === searchAsset.Equipment ||
                          selectedSearchAsset === searchAsset.GroundEquipment
                      }"
                    >
                      <label class="form-label"> {{ componentData.componentId + ".registration" | translate }} </label>

                      <div class="form-control">
                        <input type="text" [(ngModel)]="airRegistration" class="aw-input" />
                      </div>
                    </div>

                    <div class="form-group">
                      <label *ngIf="selectedSearchAsset === searchAsset.Engine" class="form-label">
                        {{ componentData.componentId + ".esnCode" | translate }}
                      </label>
                      <label *ngIf="selectedSearchAsset === searchAsset.Aircraft" class="form-label">
                        {{ componentData.componentId + ".msnCode" | translate }}
                      </label>
                      <label
                        *ngIf="
                          selectedSearchAsset === searchAsset.All ||
                          selectedSearchAsset === searchAsset.Equipment ||
                          selectedSearchAsset === searchAsset.GroundEquipment
                        "
                        class="form-label"
                      >
                        {{ componentData.componentId + ".snCode" | translate }}
                      </label>

                      <div class="form-control">
                        <input type="text" [(ngModel)]="snCode" class="aw-input" />
                      </div>
                    </div>

                    <div
                      class="form-group"
                      [ngClass]="{
                        'display--none': selectedSearchAsset === searchAsset.Aircraft
                      }"
                    >
                      <label class="form-label"> {{ componentData.componentId + ".pnCode" | translate }} </label>

                      <div class="form-control">
                        <input type="text" [(ngModel)]="pnCode" class="aw-input" />
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label" *ngIf="selectedSearchAsset === searchAsset.Aircraft">
                        {{ componentData.componentId + ".aircraftStatus" | translate }}
                      </label>
                      <label class="form-label" *ngIf="selectedSearchAsset !== searchAsset.Aircraft">
                        {{ componentData.componentId + ".operationalStatus" | translate }}
                      </label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          [options]="operationalStatusList"
                          [(ngModel)]="selectedStatus"
                          [showClear]="true"
                          placeholder="&nbsp;"
                          (keyup.enter)="search()"
                          appendTo="body"
                        ></p-dropdown>
                      </div>
                    </div>

                    <div class="form-group" *ngIf="selectedSearchAsset !== searchAsset.Engine"></div>
                  </div>
                </div>
              </div>

              <!-- EVENT CRITERIA -->
              <div class="section">
                <h4 class="section-title">2. {{ componentData.componentId + ".eventCriteria" | translate }}</h4>

                <div class="section-content">
                  <div class="row">
                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".eventCategory" | translate }} </label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          placeholder="&nbsp;"
                          [showClear]="true"
                          [options]="categoryMap"
                          [(ngModel)]="searchObject.notificationTypeCategoryCriteria"
                          (onChange)="getTypeMap()"
                          (keyup.enter)="search()"
                          appendTo="body"
                        ></p-dropdown>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".eventType" | translate }} </label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          placeholder="&nbsp;"
                          [showClear]="true"
                          [(ngModel)]="searchObject.typeCode"
                          [options]="eventTypeMap"
                          (keyup.enter)="search()"
                          appendTo="body"
                        ></p-dropdown>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".eventCode" | translate }} </label>

                      <div class="form-control">
                        <input type="text" class="aw-input" [(ngModel)]="searchObject.notificationCode" />
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".eventStatus" | translate }} </label>

                      <div class="form-control">
                        <p-dropdown
                          class="aw-dropdown fixed-width"
                          placeholder="&nbsp;"
                          [(ngModel)]="searchObject.status"
                          [showClear]="true"
                          [options]="statusMap"
                          (keyup.enter)="search()"
                          appendTo="body"
                        ></p-dropdown>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".eventDate" | translate }} </label>

                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          selectionMode="range"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          [(ngModel)]="eventDate"
                          appendTo="body"
                        ></p-calendar>
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label"> {{ componentData.componentId + ".closureDate" | translate }} </label>

                      <div class="form-control">
                        <p-calendar
                          showButtonBar="true"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="sessionService.calendarYearRange"
                          class="aw-calendar"
                          [dateFormat]="sessionService.dateFormatPrimeNG"
                          [locale]="sessionService.calendarFormat"
                          [(ngModel)]="closureDate"
                          appendTo="body"
                        ></p-calendar>
                      </div>
                    </div>
                    <div class="form-group"></div>
                    <div class="form-group"></div>
                  </div>
                </div>
              </div>

              <!-- Advanced criteria -->
              <div class="section">
                <div class="section-content">
                  <div class="advanced-criteria" [ngClass]="{ 'display--none': !showEventAdvancedCriteria }">
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".evolutionNumber" | translate }} </label>

                        <div class="form-control form-control-with-modal">
                          <div class="form-control-data" (click)="openEvolutionDialog()">
                            {{ searchObject.evolutionNumberCriteria }}
                          </div>

                          <div *ngIf="searchObject.evolutionNumberCriteria" class="btn-clear-wrapper">
                            <i
                              class="ui-dropdown-clear-icon pi pi-times aw-icon btn-clear"
                              aria-hidden="true"
                              (click)="
                                searchObject.evolutionNumberCriteria = undefined;
                                searchObject.evolutionRevisionNumberCriteria = undefined;
                                searchObject.evolutionTypeCriteria = undefined
                              "
                            ></i>
                          </div>
                          <div class="btn-search-wrapper">
                            <i
                              class="fa fa-fw fa-search aw-icon btn-search"
                              aria-hidden="true"
                              (click)="openEvolutionDialog()"
                            ></i>
                          </div>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".evolutionRevNumber" | translate }}
                        </label>

                        <div class="form-control">
                          <input
                            type="text"
                            class="aw-input"
                            [disabled]="true"
                            [(ngModel)]="searchObject.evolutionRevisionNumberCriteria"
                          />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".evolutionType" | translate }}
                        </label>

                        <div class="form-control">
                          <input
                            type="text"
                            class="aw-input"
                            [disabled]="true"
                            [(ngModel)]="searchObject.evolutionTypeCriteria"
                          />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".potentialInfo" | translate }}
                        </label>

                        <div class="form-control">
                          <p-checkbox class="aw-checkbox" binary="true" [(ngModel)]="isSearchWithCounters"></p-checkbox>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".taskCode" | translate }}
                        </label>
                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.taskCodeCriteria" />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".taskVersion" | translate }}
                        </label>
                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.taskVersionCriteria" />
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".linkedEventCode" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.notNotificationCode" />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label"> {{ componentData.componentId + ".eventCause" | translate }} </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [(ngModel)]="searchObject.cause"
                            [showClear]="true"
                            [options]="eventCauseMap"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label"> {{ componentData.componentId + ".systemId" | translate }} </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [(ngModel)]="selectedSystemId"
                            [options]="systemIdMap"
                            [showClear]="true"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label"> {{ componentData.componentId + ".systemRef" | translate }} </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="systemReference" />
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".fh" | translate }}
                        </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [(ngModel)]="rationalOperator"
                            [options]="fhMap"
                            [showClear]="true"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label"> </label>
                        <div class="form-control marginClass">
                          <input type="text" pKeyFilter="int" class="aw-input" [(ngModel)]="rationalOperand" />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".eventSubject" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.notificationSubject" />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".eventDescription" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.description" />
                        </div>
                      </div>
                      <div class="form-group"></div>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".existingFMD" | translate }}</label>
                        <div class="form-control">
                          <p-checkbox
                            class="aw-checkbox"
                            binary="true"
                            [(ngModel)]="searchObject.notificationWithFmd"
                          ></p-checkbox>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".deducedEvents" | translate }}</label>
                        <div class="form-control">
                          <p-checkbox
                            class="aw-checkbox"
                            binary="true"
                            [(ngModel)]="isDeduced"
                            (onChange)="getDeducedEvent()"
                          ></p-checkbox>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".notDeducedEvents" | translate }}</label>
                        <div class="form-control">
                          <p-checkbox
                            class="aw-checkbox"
                            binary="true"
                            (onChange)="getNotDeducedEvent()"
                            [(ngModel)]="isNotDeduced"
                          ></p-checkbox>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".defferedDefects" | translate }}</label>
                        <div class="form-control">
                          <p-checkbox
                            class="aw-checkbox"
                            binary="true"
                            [(ngModel)]="defferedDefectsSelected"
                          ></p-checkbox>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="form-label">{{ getComponentName() + ".criticalDefects" | translate }}</label>
                        <div class="form-control">
                          <p-checkbox
                            class="aw-checkbox"
                            binary="true"
                            [(ngModel)]="criticalDefectsSelected"
                          ></p-checkbox>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="section">
                <div class="section-content">
                  <div class="row search-criteria-footer">
                    <button mat-button (click)="showEventAdvancedCriteria = !showEventAdvancedCriteria">
                      <ng-container *ngIf="showEventAdvancedCriteria">
                        <mat-icon>remove</mat-icon>
                        {{ "global.collapseCriteria" | translate }}
                      </ng-container>
                      <ng-container *ngIf="!showEventAdvancedCriteria">
                        <mat-icon>add</mat-icon>
                        {{ "global.expandCriteria" | translate }}
                      </ng-container>
                    </button>
                  </div>
                </div>
              </div>

              <!-- FMD Search -->

              <div class="section">
                <div class="section-content">
                  <div class="advanced-criteria" [ngClass]="{ 'display--none': !showFMDSearchCriteria }">
                    <div class="section">
                      <br />
                      <h4 class="advanced-criteria-section-title section-header">
                        &nbsp;&nbsp;&nbsp;&nbsp;3. {{ componentData.componentId + ".rootCauseCriteria" | translate }}
                      </h4>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".rootCausePart" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCausePN" />
                        </div>
                      </div>

                      <div class="display--flex-row flex--1">
                        <div class="form-group">
                          <label class="form-label">
                            {{ componentData.componentId + ".rootCauseItem" | translate }}
                          </label>

                          <div class="form-control">
                            <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseChapter" />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">&nbsp;</label>

                          <div class="form-control">
                            <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseSection" />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">&nbsp;</label>

                          <div class="form-control">
                            <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseSheet" />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">&nbsp;</label>

                          <div class="form-control">
                            <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseSubject" />
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">&nbsp;</label>

                          <div class="form-control">
                            <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseMark" />
                          </div>
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".rootCauseFL" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.rootCauseFlCode" />
                        </div>
                      </div>
                    </div>

                    <div class="section">
                      <br />
                      <h4 class="advanced-criteria-section-title section-header">
                        &nbsp;&nbsp;&nbsp;&nbsp;4. {{ componentData.componentId + ".defectCriteria" | translate }}
                      </h4>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label"> {{ componentData.componentId + ".defectName" | translate }} </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [showClear]="true"
                            [options]="defectNameOptions"
                            [(ngModel)]="searchObject.defectName"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".defectLocation" | translate }}
                        </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [showClear]="true"
                            [options]="defectLocationOptions"
                            [(ngModel)]="searchObject.defectLocation"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".defectDescription" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.defectDescription" />
                        </div>
                      </div>
                    </div>

                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".logNumber" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="fmdLogNumber" />
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".context" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="fmdContext" />
                        </div>
                      </div>

                      <div class="form-group"></div>
                    </div>

                    <div class="section">
                      <br />
                      <h4 class="advanced-criteria-section-title section-header">
                        &nbsp;&nbsp;&nbsp;&nbsp;5. {{ componentData.componentId + ".fmdCriteria" | translate }}
                      </h4>
                    </div>
                    <div class="row">
                      <div class="form-group">
                        <label class="form-label"> {{ componentData.componentId + ".reference" | translate }} </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.fmdReferenceCriteria" />
                        </div>
                      </div>

                      <div class="display--flex-row flex--1">
                        <div class="form-group">
                          <label class="form-label">
                            {{ componentData.componentId + ".creationDate" | translate }}
                          </label>

                          <div class="form-control">
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              placeholder="&nbsp;"
                              [showClear]="false"
                              [options]="dateOptions"
                              [(ngModel)]="searchObject.fmdStartDateOrderCriteria"
                              (keyup.enter)="search()"
                              appendTo="body"
                            ></p-dropdown>
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">
                            &nbsp;
                          </label>

                          <div class="form-control">
                            <p-calendar
                              showButtonBar="true"
                              [monthNavigator]="true"
                              [yearNavigator]="true"
                              [yearRange]="sessionService.calendarYearRange"
                              class="aw-calendar"
                              [dateFormat]="sessionService.dateFormatPrimeNG"
                              [locale]="sessionService.calendarFormat"
                              appendTo="body"
                              [(ngModel)]="searchObject.fmdStartDateCriteria"
                            ></p-calendar>
                          </div>
                        </div>
                      </div>

                      <div class="display--flex-row flex--1">
                        <div class="form-group">
                          <label class="form-label">
                            {{ componentData.componentId + ".closureDate" | translate }}
                          </label>

                          <div class="form-control">
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              placeholder="&nbsp;"
                              [showClear]="false"
                              [options]="dateOptions"
                              [(ngModel)]="searchObject.fmdEndDateOrderCriteria"
                              (keyup.enter)="search()"
                              appendTo="body"
                            ></p-dropdown>
                          </div>
                        </div>

                        <div class="form-group">
                          <label class="form-label">
                            &nbsp;
                          </label>

                          <div class="form-control">
                            <p-calendar
                              showButtonBar="true"
                              [monthNavigator]="true"
                              [yearNavigator]="true"
                              [yearRange]="sessionService.calendarYearRange"
                              class="aw-calendar"
                              [dateFormat]="sessionService.dateFormatPrimeNG"
                              [locale]="sessionService.calendarFormat"
                              appendTo="body"
                              [(ngModel)]="searchObject.fmdEndDateCriteria"
                            ></p-calendar>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row">
                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".closeoutReason" | translate }}
                        </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [showClear]="true"
                            [options]="closeoutReasonOptions"
                            [(ngModel)]="searchObject.fmdCloseoutReasonCriteria"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".Status" | translate }}
                        </label>

                        <div class="form-control">
                          <p-dropdown
                            class="aw-dropdown fixed-width"
                            placeholder="&nbsp;"
                            [showClear]="true"
                            [options]="statusOptions"
                            [(ngModel)]="searchObject.fmdStatusStateCriteria"
                            (keyup.enter)="search()"
                            appendTo="body"
                          ></p-dropdown>
                        </div>
                      </div>

                      <div class="form-group">
                        <label class="form-label">
                          {{ componentData.componentId + ".author" | translate }}
                        </label>

                        <div class="form-control">
                          <input type="text" class="aw-input" [(ngModel)]="searchObject.fmdAuthorCriteria" />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="section">
                    <div class="section-content">
                      <div class="row search-criteria-footer">
                        <div
                          class="advanced-criteria-toggler"
                          *ngIf="!showFMDSearchCriteria"
                          (click)="showFMDSearchCriteria = !showFMDSearchCriteria"
                        >
                          <i class="fa fa-fw fa-plus" aria-hidden="true"></i>

                          <div class="advanced-criteria-toggler-more">
                            {{ componentData.componentId + ".fmd" | translate }}
                          </div>
                        </div>

                        <div
                          class="advanced-criteria-toggler"
                          *ngIf="showFMDSearchCriteria"
                          (click)="showFMDSearchCriteria = !showFMDSearchCriteria"
                        >
                          <i class="fa fa-fw fa-minus" aria-hidden="true"></i>

                          <div class="advanced-criteria-toggler-less">{{ "global.collapseCriteria" | translate }}</div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ACTION -->
                  <div class="section">
                    <div class="section-content">
                      <div class="row search-criteria-footer">
                        <div class="search-actions">
                          <button
                            #searchButton
                            type="button"
                            mat-raised-button
                            class="btn-with-spinner"
                            color="primary"
                            (click)="search()"
                            appKeyPress
                            [keyCode]="'Enter'"
                            (keyPress)="search()"
                          >
                            <span *ngIf="isLoading" class="lds-hourglass"></span>
                            {{ "global.toSearch" | translate }}
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="grid-row">
        <div class="grid-cell--12">
          <div #resultsContainerAnchor class="grid-cell grid-cell--container">
            <div class="grid-cell-header">
              <div class="grid-cell-title-container">
                <h3 class="grid-cell-title">
                  {{ "global.results" | translate }} ({{ resultsTableDataSource.dataCount }})
                </h3>
              </div>
            </div>

            <div class="grid-cell-content">
              <a-table [dataSource]="resultsTableDataSource">
                <ng-template tableActionsDef>
                  <button
                    *ngIf="resultsTableDataSource.hasData && !resultsTableDataSource.hasDataSelection"
                    type="button"
                    mat-raised-button
                    (click)="exportTable()"
                  >
                    {{ "global.export" | translate }}
                  </button>

                  <button
                    *ngIf="hasManageAccessRight && resultsTableDataSource.hasDataSelection"
                    type="button"
                    mat-raised-button
                    color="warn"
                    (click)="deleteEvents()"
                  >
                    {{ "global.delete" | translate }}
                  </button>

                  <button
                    *ngIf="resultsTableDataSource.hasDataSelection && deleteFmdVisible()"
                    type="button"
                    mat-raised-button
                    color="warn"
                    (click)="deleteFMDEvents()"
                  >
                    {{ componentData.componentId + ".deleteFMD" | translate }}
                  </button>

                  <button
                    *ngIf="
                      resultsTableDataSource.dataSelectionCount === 1 &&
                      resultsTableDataSource.dataSelection[0].fmdReference === 'Create FMD'
                    "
                    type="button"
                    mat-raised-button
                    (click)="openFmdEvent(resultsTableDataSource.dataSelection[0])"
                  >
                    {{ componentData.componentId + ".createFMD" | translate }}
                  </button>

                  <button
                    *ngIf="resultsTableDataSource.hasDataSelection"
                    type="button"
                    mat-raised-button
                    (click)="openSelectedEvent()"
                  >
                    {{ "global.open" | translate }}
                  </button>
                </ng-template>

                <ng-template columnDef="asset" let-rowData="rowData">
                  <a pTooltip="{{ rowData.asset }}" tooltipPosition="bottom" (click)="openAsset(rowData)">
                    {{ rowData.asset }}
                  </a>
                </ng-template>
                <ng-template columnDef="notificationCode" let-rowData="rowData">
                  <a (click)="openEvent(rowData)">
                    {{ rowData.notificationCode }}
                  </a>
                </ng-template>
                <ng-template columnDef="notificationSubject" let-rowData="rowData">
                  <a pTooltip="{{ rowData.notificationSubject }}" tooltipPosition="bottom">
                    {{ rowData.notificationSubject }}
                  </a>
                </ng-template>

                <ng-template rowExpansionDef let-rowData="rowData">
                  <div class="row">
                    <div class="form-group">
                      <label class="form-label">
                        {{ getComponentName() + ".reportingDate" | translate }}
                      </label>

                      <div class="form-control">
                        <input
                          *ngIf="!!rowData.reportingDate"
                          class="aw-input"
                          type="text"
                          [(ngModel)]="rowData.reportingDate"
                          [disabled]="true"
                        />
                        <input
                          *ngIf="rowData.reportingDate === null || rowData.reportingDate === undefined"
                          class="aw-input"
                          type="text"
                          disabled
                        />
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="form-label">
                        {{ getComponentName() + ".fmdReference" | translate }}
                      </label>

                      <div class="form-control">
                        <span
                          *ngIf="!!rowData.fmdReference && rowData.fmdReference === fmdHyperlinkCreateValue"
                          class="form-control-generic"
                        >
                          <a (click)="openFmdEvent(rowData)" style="border: none">{{
                            componentData.componentId + ".createFMD" | translate
                          }}</a>
                        </span>
                        <span
                          *ngIf="!!rowData.fmdReference && rowData.fmdReference !== fmdHyperlinkCreateValue"
                          class="form-control-generic"
                        >
                          <a (click)="openFmdEvent(rowData)" style="border: none">{{ rowData.fmdReference }}</a>
                        </span>
                        <input
                          *ngIf="rowData.fmdReference === null || rowData.fmdReference === undefined"
                          class="aw-input"
                          type="text"
                          disabled
                        />
                      </div>
                    </div>
                  </div>
                </ng-template>
                <ng-template columnDef="status" let-rowData="rowData">
                  <span *ngIf="rowData.notificationStatusVisibility">{{ rowData.status }}</span>
                </ng-template>
              </a-table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <aw-dialog-search-evolution
      *ngIf="showEvolutionDialog"
      [(display)]="showEvolutionDialog"
      (onSelected)="onSelectedEvolution($event)"
    >
    </aw-dialog-search-evolution>
  </div>
</div>
