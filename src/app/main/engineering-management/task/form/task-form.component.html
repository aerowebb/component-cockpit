<div class="page-header">
  <div class="page-info">
    <div>
      <h2 class="page-title">
        {{ "transaction." + componentData.componentId | translate }}
      </h2>

      <div class="page-subtitle">
        <div class="page-subtitle" *ngIf="!isCreateOpenMode && componentData && componentData.id">- {{ subtitle }}</div>
      </div>
      <div *ngIf="!isCreateOpenMode && previousTaskVersion">
        <a (click)="openTaskForm(previousTaskVersion)">
          <span>- {{ previousTaskVersion.taskCode }}:{{ previousTaskVersion.taskVersion }}</span>
          <span *ngIf="previousTaskVersionLastMP"> // {{ previousTaskVersionLastMP.programCode }}</span>
        </a>
      </div>
    </div>
    <div class="object-status" *ngIf="task.taskStatus" (click)="showStatus()">
      {{ task.taskStatus | formatSelectOption: statuses }}
    </div>
  </div>
  <div class="page-actions">
    <button mat-raised-button id="edit" *ngIf="isReadOpenMode && !isCreateOpenMode" (click)="editTask()">
      {{ "global.edit" | translate }}
    </button>

    <button
      *ngIf="!isReadOpenMode && !isCreateOpenMode"
      type="button"
      color="warn"
      mat-raised-button
      (click)="cancelTask()"
    >
      {{ "global.cancel" | translate }}
    </button>

    <button *ngIf="!isReadOpenMode" class="btn-with-spinner" color="primary" mat-raised-button (click)="saveTask()">
      <span class="lds-hourglass" *ngIf="showSaveSpinner"></span>
      {{ "global.save" | translate }}
    </button>

    <button
      mat-icon-button
      class="mat-elevation-z1"
      matTooltip="{{ 'global.showAllActionTooltip' | translate }}"
      matTooltipPosition="above"
      aria-label="Show all actions"
      [matMenuTriggerFor]="actions"
    >
      <mat-icon>more_horiz</mat-icon>
    </button>
    <mat-menu #actions="matMenu">
      <button mat-menu-item (click)="openStatusUpdatesPopup()">{{ "updates" | translate }}</button>
      <button *ngIf="showUpgradeButton" type="button" mat-menu-item (click)="upgradeTask()">
        {{ getComponentName() + ".upgrade" | translate }}
      </button>
      <button mat-menu-item (click)="refresh()">{{ "global.refresh" | translate }}</button>
      <button mat-menu-item (click)="updateFavoriteState()">{{ "addToFavorite" | translate }}</button>
    </mat-menu>
  </div>
</div>

<div class="page-wrapper">
  <div class="page-container">
    <mat-tab-group animationDuration="0ms" dynamicHeight>
      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightHome }">{{ "home" | translate }}</span>
        </ng-template>

        <div class="grid-row">
          <div class="grid-cell--6 grid-cell--no-padding">
            <div class="grid-row">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ "page.mainData" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content">
                    <div class="column">
                      <div class="row">
                        <div id="taskCode" class="form-group" [ngClass]="{ required: !isReadOpenMode }">
                          <label class="form-label">{{ getComponentName() + ".taskCode" | translate }} </label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskCode"
                              [disabled]="isReadOpenMode || !isCreateOpenMode"
                              maxlength="50"
                            />
                          </div>
                        </div>

                        <div id="taskVersion" class="form-group" [ngClass]="{ required: !isReadOpenMode }">
                          <label class="form-label">{{ getComponentName() + ".taskVersion" | translate }} </label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskVersion"
                              [disabled]="isReadOpenMode || !isCreateOpenMode"
                              maxlength="50"
                            />
                          </div>
                        </div>

                        <div id="taskType" class="form-group" [ngClass]="{ required: !isReadOpenMode }">
                          <label class="form-label">{{ getComponentName() + ".taskType" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.TASK_TYPE) }"
                          >
                            <p-dropdown
                              class="aw-dropdown fixed-width"
                              [options]="taskTypes"
                              [(ngModel)]="task.taskTypeCode"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div id="applicabilityDate" class="form-group">
                          <label class="form-label">{{ "global.applicabilityDate" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.APPLICABILITY_DATE) }"
                          >
                            <p-calendar
                              showButtonBar="true"
                              [monthNavigator]="true"
                              [yearNavigator]="true"
                              [yearRange]="sessionService.calendarYearRange"
                              class="aw-calendar"
                              [dateFormat]="sessionService.dateFormatPrimeNG"
                              [locale]="sessionService.calendarFormat"
                              [(ngModel)]="task.taskApplicabilityDate"
                              [disabled]="isReadOpenMode"
                            ></p-calendar>
                          </div>
                        </div>

                        <div id="taskGroups" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".group" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.TASK_GROUP) }"
                          >
                            <p-dropdown
                              class="aw-dropdown  fixed-width"
                              [options]="taskGroups"
                              [(ngModel)]="task.groupCode"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                        </div>

                        <div id="taskApplicabilityCode" class="form-group">
                          <label class="form-label">{{
                            componentData.componentId + ".taskApplicabilityCode" | translate
                          }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.APPLICABILITY_CODE) }"
                          >
                            <p-dropdown
                              class="aw-dropdown  fixed-width"
                              [options]="applicabilities"
                              [(ngModel)]="task.taskApplicabilityCode"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div id="taskDesignation" class="form-group flex--2">
                          <label class="form-label">{{
                            componentData.componentId + ".taskDesignation" | translate
                          }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.DESIGNATION) }"
                          >
                            <div *ngIf="taskDesignationDiff && isReadOpenMode" [innerHTML]="taskDesignationDiff"></div>
                            <textarea
                              *ngIf="!taskDesignationDiff || !isReadOpenMode"
                              pInputTextarea
                              [rows]="3"
                              class="aw-textarea"
                              [(ngModel)]="task.taskDesignation"
                              [disabled]="isReadOpenMode"
                              maxlength="1000"
                            ></textarea>
                          </div>
                        </div>

                        <div id="isCritical" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".isCritical" | translate }}</label>

                          <div class="form-control">
                            <p-checkbox
                              class="aw-checkbox"
                              binary="true"
                              [(ngModel)]="isCritical"
                              [disabled]="isReadOpenMode"
                              (onChange)="changeIsCriticalDynamicAttribute()"
                            ></p-checkbox>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-row">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ "page.additionalData" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content">
                    <div class="column">
                      <div class="row">
                        <div id="mroCenter" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".mroCenter" | translate }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.MRO_CENTER) }"
                          >
                            <p-dropdown
                              class="aw-dropdown  fixed-width"
                              [options]="mroCenters"
                              [(ngModel)]="task.repairCenterCode"
                              [showClear]="true"
                              placeholder="&nbsp;"
                              [disabled]="isReadOpenMode"
                            ></p-dropdown>
                          </div>
                        </div>

                        <div id="inspectionPerEsm" class="form-group">
                          <label class="form-label">{{
                            componentData.componentId + ".inspectionPerEsm" | translate
                          }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.INSPECTION_ESM) }"
                          >
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.inspectionPerEsm"
                              [disabled]="isReadOpenMode"
                              maxlength="300"
                            />
                          </div>
                        </div>

                        <div id="overhaul" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".overhaul" | translate }}</label>

                          <div class="form-control">
                            <p-checkbox
                              class="aw-checkbox"
                              binary="true"
                              [(ngModel)]="task.overhaul"
                              [disabled]="isReadOpenMode"
                              [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.OVERHAUL) }"
                            ></p-checkbox>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div id="taskZone" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskZone" | translate }}</label>

                          <div class="form-control" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.ZONE) }">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskZone"
                              [disabled]="isReadOpenMode"
                              maxlength="300"
                            />
                          </div>
                        </div>

                        <div *ngIf="isCostSettingEnabled" id="cost" class="form-group cost-field">
                          <label class="form-label">
                            {{ componentData.componentId + ".cost" | translate }}
                            <span *ngIf="currency">({{ currency }})</span>
                          </label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.TOTAL_COST) }"
                          >
                            <input type="text" class="aw-input" [disabled]="true" [ngModel]="totalCost" />
                          </div>
                        </div>

                        <div class="form-group"></div>
                      </div>

                      <div class="row">
                        <div id="taskDescription" class="form-group flex--3">
                          <label class="form-label">{{
                            componentData.componentId + ".taskDescription" | translate
                          }}</label>

                          <div
                            class="form-control"
                            [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.DESCRIPTION) }"
                          >
                            <div *ngIf="taskDescriptionDiff && isReadOpenMode" [innerHTML]="taskDescriptionDiff"></div>
                            <textarea
                              *ngIf="!taskDescriptionDiff || !isReadOpenMode"
                              pInputTextarea
                              [rows]="5"
                              class="aw-textarea"
                              [(ngModel)]="task.taskDescription"
                              [disabled]="isReadOpenMode"
                              [maxlength]="15000"
                            ></textarea>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid-cell--6 grid-cell--no-padding">
            <div class="grid-row">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ componentData.componentId + ".referenceManual" | translate }}
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content">
                    <div class="column">
                      <div class="row" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.REFERENCE_MANUAL) }">
                        <div id="taskChapter" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskChapter" | translate }}</label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskChapter"
                              [disabled]="isReadOpenMode"
                              maxlength="5"
                            />
                          </div>
                        </div>

                        <div id="taskSection" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskSection" | translate }}</label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskSection"
                              [disabled]="isReadOpenMode"
                              maxlength="5"
                            />
                          </div>
                        </div>

                        <div id="taskSubject" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskSubject" | translate }}</label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskSubject"
                              [disabled]="isReadOpenMode"
                              maxlength="6"
                            />
                          </div>
                        </div>

                        <div id="taskTask" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskTask" | translate }}</label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskTask"
                              [disabled]="isReadOpenMode"
                              maxlength="50"
                            />
                          </div>
                        </div>

                        <div id="taskSubTask" class="form-group">
                          <label class="form-label">{{ componentData.componentId + ".taskSubTask" | translate }}</label>

                          <div class="form-control">
                            <input
                              type="text"
                              class="aw-input"
                              [(ngModel)]="task.taskSubTask"
                              [disabled]="isReadOpenMode"
                              maxlength="50"
                            />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-row">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ componentData.componentId + ".maintenancePrograms" | translate }} ({{
                          maintenanceProgramsTableDataSource ? maintenanceProgramsTableDataSource.dataCount : 0
                        }})
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content grid-cell-content-with-section">
                    <div class="section">
                      <div
                        class="section-content"
                        [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.MAINTENANCE_PROGRAMS) }"
                      >
                        <a-table [dataSource]="maintenanceProgramsTableDataSource">
                          <ng-template columnDef="programCode" let-rowData="rowData">
                            <a (click)="openMaintenanceProgramsForm(rowData)">{{ rowData.programCode }}</a>
                          </ng-template>
                        </a-table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid-row">
              <div class="grid-cell--12">
                <div class="grid-cell grid-cell--container">
                  <div class="grid-cell-header">
                    <div class="grid-cell-title-container">
                      <h3 class="grid-cell-title">
                        {{ componentData.componentId + ".shopManuals" | translate }} ({{
                          shopManualsTableDataSource ? shopManualsTableDataSource.dataCount : 0
                        }})
                      </h3>
                    </div>
                  </div>

                  <div class="grid-cell-content grid-cell-content-with-section">
                    <div class="section">
                      <div class="section-content">
                        <a-table [dataSource]="shopManualsTableDataSource"> </a-table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightTaskCard }">{{ getComponentName() + ".taskCard" | translate }}</span>
        </ng-template>

        <div class="grid-row">
          <div class="grid-cell--12">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ getComponentName() + ".ope" | translate }}
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <h4 class="section-title">
                    {{ componentData.componentId + ".operation" | translate }} ({{
                      operationTableDataSource ? operationTableDataSource.dataCount : 0
                    }})
                  </h4>

                  <div class="section-content" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.OPERATIONS) }">
                    <a-table [dataSource]="operationTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && operationTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteOperation()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="operationTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openOperation()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !operationTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createOperation()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="ope" let-rowData="rowData">
                        <a (click)="openOperationForm(rowData)">{{ rowData.ope }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid-row">
          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".superiorTasks" | translate }} ({{
                      superiorTableDataSource ? superiorTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.SUPERIOR_TASKS) }"
                  >
                    <a-table [dataSource]="superiorTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && superiorTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteSuperiorTask()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && superiorTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="editSuperiorTask()"
                        >
                          {{ "global.edit" | translate }}
                        </button>

                        <button
                          *ngIf="superiorTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openSuperiorTask()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !superiorTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createSuperiorTask()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="taskCode" let-rowData="rowData">
                        <a (click)="openTaskForm(rowData)">{{ rowData.taskCode }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".topDownTaskStructure" | translate }}
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.TOP_DOWN_STRUCTURE) }"
                  >
                    <p-treeTable
                      #ptreetableTopDown
                      class="aw-tree-table2"
                      [value]="topDownTreeTable"
                      [columns]="topDownTaskStructureTableCols"
                      selectionMode="checkbox"
                      [(selection)]="selectedTopDownNodes"
                      (onNodeSelect)="onRowSelected($event.node)"
                      (onNodeUnselect)="onRowUnSelected($event.node)"
                      [scrollable]="true"
                      [resizableColumns]="true"
                    >
                      <ng-template pTemplate="emptymessage">
                        <span *ngIf="!isLoadingTopDownTreeTable"> &nbsp;</span>

                        <div *ngIf="isLoadingTopDownTreeTable" class="aw-table-loading-indicator">
                          <div class="loading-message">{{ "table.loadingData" | translate }}</div>
                          <div class="lds-hourglass"></div>
                        </div>
                      </ng-template>

                      <ng-template pTemplate="caption">
                        <div class="aw-table-header" [ngClass]="{ 'rows-selected': selectedTopDownNodes.length > 0 }">
                          <div class="aw-table-global-filter">
                            <label class="aw-table-global-filter-label">
                              <i class="fa fa-fw fa-search" aria-hidden="true"></i>
                            </label>

                            <input
                              #ptreetableTopDownGlobalFilter
                              class="aw-table-global-filter-input"
                              type="text"
                              placeholder="{{ 'table.globalFilterText' | translate }}"
                              (input)="ptreetableTopDown.filterGlobal($event.target.value, 'contains')"
                            />
                          </div>

                          <div class="aw-table-actions">
                            <button
                              *ngIf="
                                !isReadOpenMode &&
                                selectedTopDownNodes.length === 1 &&
                                selectedTopDownNodes[0].parent !== null
                              "
                              type="button"
                              mat-raised-button
                              color="warn"
                              (click)="deleteTopDownTask()"
                            >
                              {{ "global.delete" | translate }}
                            </button>

                            <button
                              *ngIf="!isReadOpenMode && selectedTopDownNodes.length === 1"
                              type="button"
                              mat-raised-button
                              (click)="editTopDownTask()"
                            >
                              {{ "global.edit" | translate }}
                            </button>

                            <button
                              *ngIf="selectedTopDownNodes.length === 1"
                              type="button"
                              mat-raised-button
                              (click)="openTopDownTask()"
                            >
                              {{ "global.open" | translate }}
                            </button>

                            <button
                              *ngIf="!isReadOpenMode && selectedTopDownNodes.length === 0"
                              type="button"
                              mat-raised-button
                              (click)="createTopDownTask()"
                            >
                              {{ "global.add" | translate }}
                            </button>
                          </div>
                        </div>
                      </ng-template>

                      <ng-template pTemplate="colgroup" let-columns>
                        <colgroup>
                          <col class="aw-table-checkbox-wrapper" [ngClass]="{ 'display--none': isReadOpenMode }" />
                          <col *ngFor="let col of columns" [ngStyle]="{ width: col.width }" />
                        </colgroup>
                      </ng-template>

                      <ng-template pTemplate="header" let-columns>
                        <tr>
                          <th class="aw-table-checkbox-wrapper" [ngClass]="{ 'display--none': isReadOpenMode }">
                            <p-treeTableHeaderCheckbox class="aw-table-checkbox"></p-treeTableHeaderCheckbox>
                          </th>

                          <th ttResizableColumn *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.alignment }">
                            {{ componentData.componentId + "." + col.field | translate }}
                          </th>
                        </tr>
                      </ng-template>

                      <ng-template pTemplate="body" let-rowNode let-rowData="rowData" let-columns="columns">
                        <tr>
                          <td class="aw-table-checkbox-wrapper" [ngClass]="{ 'display--none': isReadOpenMode }">
                            <p-treeTableCheckbox class="aw-table-checkbox" [value]="rowNode"></p-treeTableCheckbox>
                          </td>

                          <td *ngFor="let col of columns; let i = index" [ngStyle]="{ 'text-align': col.alignment }">
                            <p-treeTableToggler [rowNode]="rowNode" *ngIf="i == 0"></p-treeTableToggler>

                            <span [ngSwitch]="col.field">
                              <a *ngSwitchCase="'taskCode'" (click)="openTaskForm(rowData['bireTaskDTO'])">{{
                                rowData["bireTaskDTO"][col.field]
                              }}</a>

                              <span *ngSwitchCase="'sequenceNumber'"> {{ rowData[col.field] }} </span>

                              <span *ngSwitchDefault> {{ rowData["bireTaskDTO"][col.field] }} </span>
                            </span>
                          </td>
                        </tr>
                      </ng-template>
                    </p-treeTable>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid-row">
          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".anterior" | translate }} ({{
                      anteriorTaskTableDataSource ? anteriorTaskTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.ANTERIOR_TASKS) }"
                  >
                    <a-table [dataSource]="anteriorTaskTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && anteriorTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteAnterior()"
                          [disabled]="!anteriorTaskTableDataSource.hasDataSelection"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && anteriorTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="editAnterior()"
                        >
                          {{ "global.edit" | translate }}
                        </button>

                        <button
                          *ngIf="anteriorTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openMaintenancePrograms()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !anteriorTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createAnterior()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="taskCode" let-rowData="rowData">
                        <a (click)="openTaskForm(rowData)">{{ rowData.taskCode }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".posterior" | translate }} ({{
                      posteriorTaskTableDataSource ? posteriorTaskTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.POSTERIOR_TASKS) }"
                  >
                    <a-table [dataSource]="posteriorTaskTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && posteriorTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deletePosterior()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && posteriorTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="editPosterior()"
                        >
                          {{ "global.edit" | translate }}
                        </button>

                        <button
                          *ngIf="posteriorTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openPosterior()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !posteriorTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createPosterior()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="taskCode" let-rowData="rowData">
                        <a (click)="openTaskForm(rowData)">{{ rowData.taskCode }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="grid-row">
          <div class="grid-cell--12">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".linkedTasks" | translate }} ({{
                      linkedTaskTableDataSource ? linkedTaskTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.LINKED_TASK) }"
                  >
                    <a-table [dataSource]="linkedTaskTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && linkedTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteLinkedTasks()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && linkedTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="editLinkedTasks()"
                        >
                          {{ "global.edit" | translate }}
                        </button>

                        <button
                          *ngIf="linkedTaskTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openLinkedTasks()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !linkedTaskTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createLinkedTasks()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="taskCode" let-rowData="rowData">
                        <a (click)="openTaskForm(rowData)">{{ rowData.taskCode }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightImpacts }">{{ getComponentName() + ".impacts" | translate }}</span>
        </ng-template>

        <div class="grid-row">
          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".evolutions" | translate }} ({{
                      evolutionsTableDataSource ? evolutionsTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div class="section-content" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.EVOLUTIONS) }">
                    <a-table [dataSource]="evolutionsTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && evolutionsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteEvolution()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && evolutionsTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openEvolution()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !evolutionsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createEvolution()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="evolutionNumber" let-rowData="rowData">
                        <a (click)="openEvolutionForm(rowData)">{{ rowData.evolutionNumber }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".maintainedItems" | translate }} ({{
                      maintainedItemsTableDataSource ? maintainedItemsTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div class="section-content" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.ITEMLINKED) }">
                    <a-table [dataSource]="maintainedItemsTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && maintainedItemsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteMaintainedItem()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && maintainedItemsTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openMaintainedItem()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !maintainedItemsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createMaintainedItem()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                      <ng-template columnDef="item" let-rowData="rowData">
                        <a (click)="openItem(rowData)">{{ rowData.item }}</a>
                      </ng-template>
                      <ng-template columnDef="field" let-rowData="rowData">
                        <a (click)="openField(rowData)">{{ rowData.field }}</a>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightPrerequisites }"
            >{{ getComponentName() + ".prerequisites" | translate }}
          </span>
        </ng-template>

        <div class="grid-row">
          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".qualifications" | translate }} ({{
                      qualificationsTableDataSource ? qualificationsTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.ASSOCIATED_QUALIFICATIONS) }"
                  >
                    <a-table [dataSource]="qualificationsTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && qualificationsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteQualification()"
                          [disabled]="!qualificationsTableDataSource.hasDataSelection"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && qualificationsTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openQualification()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !qualificationsTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createQualification()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid-cell--6">
            <div class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".til" | translate }} ({{
                      tilTableDataSource ? tilTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content grid-cell-content-with-section">
                <div class="section">
                  <div
                    class="section-content"
                    [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.TECHNICAL_LEVEL) }"
                  >
                    <a-table [dataSource]="tilTableDataSource">
                      <ng-template tableActionsDef>
                        <button
                          *ngIf="!isReadOpenMode && tilTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          color="warn"
                          (click)="deleteTil()"
                        >
                          {{ "global.delete" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && tilTableDataSource.dataSelectionCount === 1"
                          type="button"
                          mat-raised-button
                          (click)="openTil()"
                        >
                          {{ "global.open" | translate }}
                        </button>

                        <button
                          *ngIf="!isReadOpenMode && !tilTableDataSource.hasDataSelection"
                          type="button"
                          mat-raised-button
                          (click)="createTil()"
                        >
                          {{ "global.add" | translate }}
                        </button>
                      </ng-template>
                    </a-table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightAttributes }"> {{ "attributes" | translate }}</span>
        </ng-template>

        <div class="grid-row">
          <div id="attributesPanel" class="grid-cell--12">
            <div #attributesAnchor class="grid-cell grid-cell--container">
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ componentData.componentId + ".attributes" | translate }}
                  </h3>
                </div>
              </div>
              <div
                class="grid-cell-content grid-cell-content-with-section"
                [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.ATTRIBUTES) }"
              >
                <aw-dynamic-attributes [attributes]="dynamicAttributesForTask" [isReadOpenMode]="isReadOpenMode">
                </aw-dynamic-attributes>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightDocuments }">{{ "documents" | translate }}</span>
        </ng-template>

        <div class="grid-row">
          <div class="grid-cell--12" (click)="selectPageTocEntry(component.DOCUMENTS_ANCHOR_ID)">
            <div
              class="grid-cell grid-cell--container"
              [ngClass]="{ active: isPageTocEntrySelected(component.DOCUMENTS_ANCHOR_ID) }"
            >
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ getComponentName() + ".documents" | translate }} ({{
                      documentsTableDataSource ? documentsTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>

              <div class="grid-cell-content" [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.DOCUMENTS) }">
                <a-table [dataSource]="documentsTableDataSource">
                  <ng-template tableActionsDef>
                    <button
                      *ngIf="!isReadOpenMode && documentsTableDataSource.hasDataSelection"
                      type="button"
                      mat-raised-button
                      color="warn"
                      (click)="deleteDocuments()"
                    >
                      {{ "global.delete" | translate }}
                    </button>

                    <button
                      *ngIf="!isReadOpenMode && documentsTableDataSource.dataSelectionCount === 1"
                      type="button"
                      mat-raised-button
                      (click)="editDocument()"
                    >
                      {{ "global.edit" | translate }}
                    </button>

                    <button
                      *ngIf="!isReadOpenMode && !documentsTableDataSource.hasDataSelection"
                      type="button"
                      mat-raised-button
                      (click)="addDocument()"
                    >
                      {{ "global.add" | translate }}
                    </button>
                  </ng-template>
                  <ng-template columnDef="docName" let-rowData="rowData">
                    <a (click)="downloadDocument(rowData)">{{ rowData.docName }}</a>
                  </ng-template>
                  <ng-template columnDef="docExtension" let-rowData="rowData">
                    {{ showDocExtension(rowData) }}
                  </ng-template>
                  <ng-template columnDef="docPublicationDate" let-rowData="rowData">
                    {{ rowData.docPublicationDate | date: "yyyy/MM/dd":"":translateService.currentLang }}
                  </ng-template>
                  <ng-template columnDef="docSource" let-rowData="rowData">
                    {{ rowData.docSource }}
                    <i
                      *ngIf="validateUrl(rowData.docSource)"
                      class="fa fa-fw fa-external-link aw-icon aw-icon-with-border"
                      aria-hidden="true"
                      pTooltip="{{ 'global.open' | translate }}"
                      tooltipPosition="top"
                      (click)="openUrl(rowData.docSource)"
                    ></i>
                  </ng-template>
                </a-table>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab>
        <ng-template mat-tab-label>
          <span [ngClass]="{ highlight: highlightMeasurementPoint }">{{ "measurementPoints" | translate }}</span>
        </ng-template>
        <div class="grid-row">
          <div
            #measurementPointsAnchor
            class="grid-cell--12"
            (click)="selectPageTocEntry(component.MEASUREMENT_POINTS_ANCHOR_ID)"
          >
            <div
              class="grid-cell grid-cell--container"
              [ngClass]="{ active: isPageTocEntrySelected(component.MEASUREMENT_POINTS_ANCHOR_ID) }"
            >
              <div class="grid-cell-header">
                <div class="grid-cell-title-container">
                  <h3 class="grid-cell-title">
                    {{ getComponentName() + ".measurementPoints" | translate }} ({{
                      measurementPointsTableDataSource ? measurementPointsTableDataSource.dataCount : 0
                    }})
                  </h3>
                </div>
              </div>
              <div
                class="grid-cell-content"
                [ngClass]="{ highlight: isUpdatedField(TaskFieldsConstant.MEASUREMENT_POINT) }"
              >
                <a-table [dataSource]="measurementPointsTableDataSource">
                  <ng-template tableActionsDef>
                    <button
                      mat-raised-button
                      *ngIf="!isReadOpenMode && measurementPointsTableDataSource.hasDataSelection"
                      type="button"
                      (click)="deleteMeasurementPoints(measurementPointsTableDataSource.dataSelection)"
                    >
                      {{ "global.delete" | translate }}
                    </button>

                    <button
                      mat-raised-button
                      *ngIf="!isReadOpenMode && measurementPointsTableDataSource.dataSelectionCount === 1"
                      type="button"
                      (click)="updateMeasurementPoint()"
                    >
                      {{ "global.update" | translate }}
                    </button>

                    <button
                      mat-raised-button
                      color="warn"
                      *ngIf="measurementPointsTableDataSource.dataSelectionCount === 1"
                      type="button"
                      (click)="openMeasurementPoint()"
                    >
                      {{ "global.open" | translate }}
                    </button>

                    <button
                      *ngIf="!isReadOpenMode && !measurementPointsTableDataSource.hasDataSelection"
                      mat-raised-button
                      type="button"
                      (click)="addMeasurementPoint()"
                    >
                      {{ "global.add" | translate }}
                    </button>
                    <button
                      *ngIf="!isReadOpenMode && measurementPointsTableDataSource.dataSelectionCount === 1"
                      mat-raised-button
                      type="button"
                      (click)="toolMeasurementPoint()"
                    >
                      {{ getComponentName() + ".tool" | translate }}
                    </button>
                    <button
                      mat-raised-button
                      *ngIf="!isReadOpenMode && showMeasurementPointLinkButton()"
                      type="button"
                      (click)="linkMeasurementPoints()"
                    >
                      {{ getComponentName() + ".link" | translate }}
                    </button>
                    <button
                      mat-raised-button
                      *ngIf="!isReadOpenMode && showMeasurementPointUnLinkButton()"
                      type="button"
                      (click)="unLinkMeasurementPoints()"
                    >
                      {{ getComponentName() + ".unLink" | translate }}
                    </button>
                    <button
                      *ngIf="!isReadOpenMode && showMeasurementPointFormulaButton()"
                      mat-raised-button
                      type="button"
                      (click)="formulaMeasurementPoint()"
                    >
                      {{ getComponentName() + ".formula" | translate }}
                    </button>
                  </ng-template>
                </a-table>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>

    <aw-dialog-search-operation
      *ngIf="showOperationDialog"
      [(display)]="showOperationDialog"
      (onValidated)="onAddOperation($event)"
    ></aw-dialog-search-operation>

    <aw-dialog-operations-popup
      *ngIf="showOperationFormDialog"
      [(display)]="showOperationFormDialog"
      [isReadOnlyForm]="isReadOnlyOperationDialog"
      [operation]="currentOperation"
    ></aw-dialog-operations-popup>

    <aw-dialog-evolutions-popup
      *ngIf="showEvolutionsDialog"
      [evolution]="currentEvolution"
      [(display)]="showEvolutionsDialog"
      [isReadOnlyForm]="isReadOnlyEvolutionsDialog"
      (onAdded)="onAddEvolution($event)"
    >
    </aw-dialog-evolutions-popup>

    <aw-dialog-item-versions-popup
      *ngIf="showMaintainedItemsDialog"
      [item]="currentMaintainedItem"
      [(display)]="showMaintainedItemsDialog"
      [isReadOnlyForm]="isReadOnlyMaintainedItemsDialog"
      (onAdded)="onAddedMaintainedItem($event)"
    ></aw-dialog-item-versions-popup>

    <aw-dialog-search-qualification
      *ngIf="showQualificationsDialog"
      [(display)]="showQualificationsDialog"
      (onSelected)="onAddedQualification($event)"
    >
    </aw-dialog-search-qualification>

    <aw-dialog-tils-popup
      *ngIf="showTilDialog"
      [tilInput]="currentTil"
      [(display)]="showTilDialog"
      [isReadOnlyForm]="isReadOnlyTilDialog"
      (onAdded)="onAddedTil($event)"
    ></aw-dialog-tils-popup>

    <aw-dialog-associated-tasks-popup
      *ngIf="showSuperiorTasksDialog"
      [isNewForm]="isCreateOpenMode"
      [linkTypes]="superior"
      [isDisplayLinkType]="false"
      [associatedTasks]="currentSuperiorTask"
      [(display)]="showSuperiorTasksDialog"
      [isReadOnlyForm]="isReadOnlySuperiorTasksDialog"
      (onAssociated)="onAssociatedSuperiorTask($event)"
    ></aw-dialog-associated-tasks-popup>

    <aw-dialog-associated-tasks-popup
      *ngIf="showTopDownTasksDialog"
      [linkTypes]="topDown"
      [isNewForm]="isCreateOpenMode"
      [isDisplayLinkType]="false"
      [associatedTasks]="currentTopDownTask"
      [(display)]="showTopDownTasksDialog"
      [isReadOnlyForm]="isReadOnlyTopDownTasksDialog"
      (onAssociated)="onAssociatedTopDownTask($event)"
    >
    </aw-dialog-associated-tasks-popup>

    <aw-dialog-associated-tasks-popup
      *ngIf="showAnteriorTasksDialog"
      [linkTypes]="anterior"
      [isNewForm]="isCreateOpenMode"
      [isDisplayLinkType]="false"
      [associatedTasks]="currentAnterior"
      [(display)]="showAnteriorTasksDialog"
      [isReadOnlyForm]="isReadOnlyAnteriorDialog"
      (onAssociated)="onAssociatedAnteriorTask($event)"
    ></aw-dialog-associated-tasks-popup>

    <aw-dialog-associated-tasks-popup
      *ngIf="showPosteriorDialog"
      [linkTypes]="posterior"
      [isNewForm]="isCreateOpenMode"
      [isDisplayLinkType]="false"
      [associatedTasks]="currentPosterior"
      [(display)]="showPosteriorDialog"
      [isReadOnlyForm]="isReadOnlyPosteriorDialog"
      (onAssociated)="onAssociatedPosteriorTask($event)"
    >
    </aw-dialog-associated-tasks-popup>

    <aw-dialog-associated-tasks-popup
      *ngIf="showLinkedTasksDialog"
      [linkTypes]="linked"
      [isNewForm]="isCreateOpenMode"
      [isDisplayLinkType]="true"
      [associatedTasks]="currentLinkedTask"
      [(display)]="showLinkedTasksDialog"
      [isReadOnlyForm]="isReadOnlyLinkedTasksDialog"
      (onAssociated)="onAssociatedLinkedTask($event)"
    >
    </aw-dialog-associated-tasks-popup>

    <aw-task-import-popup
      *ngIf="showDocumentDialog"
      [document]="currentDocument"
      [(display)]="showDocumentDialog"
      [isReadOnlyForm]="isReadOnlyDocumentDialog"
      (onValidated)="updateDocument($event)"
    ></aw-task-import-popup>

    <aw-status-update-history
      *ngIf="showStatusUpdatesPopup"
      [object]="task"
      [data]="tableStatusUpdatesData"
      [deleteApi]="deleteApi"
      [(display)]="showStatusUpdatesPopup"
      [keyMap]="updatesKeyMap"
      [isStatusEditable]="false"
      (onUpdated)="updateObjectStatusFromStatusUpdatesHistory($event)"
    >
    </aw-status-update-history>

    <aw-dynamic-attributes-history
      *ngIf="showDynamicAttributesHistoric"
      [attributes]="dynamicAttributesForTask"
      [history]="dynamicAttributesHistoric"
      showDelete="true"
      [deleteApi]="taskHistoryApi.removeHBireTaskAttribute"
      [(display)]="showDynamicAttributesHistoric"
    ></aw-dynamic-attributes-history>

    <aw-task-import-popup
      *ngIf="showAddDocumentDialog"
      [document]="currentDocument"
      [(display)]="showAddDocumentDialog"
      [isReadOnlyForm]="isReadOnlyDocumentDialog"
      (onValidated)="addNewDocument($event)"
    ></aw-task-import-popup>

    <aw-dialog-measure-popup
      *ngIf="showMeasurementPointDialog"
      [(display)]="showMeasurementPointDialog"
      [openMode]="measurementPointDialogOpenMode"
      [hasRefMeasurementLinked]="isLinkedRefMeasurementCode"
      [data]="measurementPointRowData"
      (onValidatedMeasurementPoint)="onValidatedMeasurementRow($event)"
    ></aw-dialog-measure-popup>
    <aw-dialog-measure-tool-popup
      *ngIf="showAddMeasurementPointToolDialog"
      [(display)]="showAddMeasurementPointToolDialog"
      (onValidated)="setSelectedTool($event)"
      [searchInput]="pnTaskSearchInput"
    >
    </aw-dialog-measure-tool-popup>

    <aw-dialog-measure-formula-popup
      *ngIf="showAddMeasurementPointFormulaDialog"
      [selectedMeasurePoint]="
        measurementPointsTableDataSource.dataSelection[0] &&
        measurementPointsTableDataSource.dataSelection[0].counterCode
      "
      [selectedMeasurePointTitle]="
        measurementPointsTableDataSource.dataSelection[0] &&
        measurementPointsTableDataSource.dataSelection[0].counterRemarks
      "
      [selectedMeasurePointFormula]="
        measurementPointsTableDataSource.dataSelection[0] && measurementPointsTableDataSource.dataSelection[0].formula
      "
      [measureList]="measurementPointsTableDataSource.dataSrc"
      [(display)]="showAddMeasurementPointFormulaDialog"
      (onValidated)="setFormula($event)"
    ></aw-dialog-measure-formula-popup>
  </div>
</div>
