<a-modal class="aw-modal" [(visible)]="display">
  <a-header>
    <div class="modal-title">
      {{ tableData.componentId + ".title" | translate }} ({{ formattedTableRows ? formattedTableRows.length : 0 }})
    </div>
  </a-header>

  <a-content>
    <p-table
      [resizableColumns]="true"
      #ptable
      class="aw-table2"
      [columns]="tableData.tableCols"
      [value]="formattedTableRows"
      [selectionMode]="tableData.selectionMode"
      [(selection)]="selection"
      [dataKey]="!!tableData.dataKey ? '_id' : undefined"
      [scrollable]="true"
    >
      <ng-template pTemplate="emptymessage">
        <span *ngIf="!isLoading"> &nbsp;</span>

        <div *ngIf="isLoading" class="aw-table-loading-indicator">
          <div class="loading-message">{{ "table.loadingData" | translate }}</div>
          <div class="lds-hourglass"></div>
        </div>
      </ng-template>

      <ng-template pTemplate="caption">
        <div class="aw-table-header">
          <div class="aw-table-global-filter">
            <label class="aw-table-global-filter-label"> <i class="fa fa-fw fa-search" aria-hidden="true"></i> </label>

            <input
              #ptableGlobalFilter
              class="aw-table-global-filter-input"
              type="text"
              placeholder="{{ 'table.globalFilterText' | translate }}"
              (input)="ptable.filterGlobal($event.target.value, 'contains')"
            />
          </div>
        </div>
      </ng-template>

      <ng-template pTemplate="colgroup" let-columns>
        <colgroup>
          <col *ngIf="tableData.selectionMode === tableSelectionMode.Multiple" class="aw-table-checkbox-wrapper" />
          <col *ngFor="let col of columns" [ngStyle]="{ width: col.width }" />
        </colgroup>
      </ng-template>

      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngIf="tableData.selectionMode === tableSelectionMode.Multiple" class="aw-table-checkbox-wrapper">
            <p-tableHeaderCheckbox class="aw-table-checkbox"></p-tableHeaderCheckbox>
          </th>

          <th pResizableColumn *ngFor="let col of columns" [ngStyle]="{ 'text-align': col.alignment }">
            {{ tableData.componentId + "." + col.field | translate }}
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData let-columns="columns" let-rowIndex="rowIndex">
        <tr [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex">
          <td *ngIf="tableData.selectionMode === tableSelectionMode.Multiple" class="aw-table-checkbox-wrapper">
            <p-tableCheckbox class="aw-table-checkbox" [value]="rowData"></p-tableCheckbox>
          </td>

          <td *ngFor="let col of columns" [ngSwitch]="col.filterMode" [ngStyle]="{ 'text-align': col.alignment }">
            <span *ngSwitchCase="tableColumnFilterMode.Tricheckbox">
              <i
                *ngIf="rowData[col.field] !== null && rowData[col.field]"
                class="fa fa-fw fa-check"
                aria-hidden="true"
              ></i>
            </span>

            <span *ngSwitchDefault> {{ rowData[col.field] }} </span>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </a-content>

  <a-footer>
    <button type="button" mat-raised-button (click)="closeDialog()">
      <span>{{ "global.cancel" | translate }}</span>
    </button>

    <button type="button" mat-raised-button color="primary" (click)="validate()" [disabled]="!selection">
      <span>{{ "global.validate" | translate }}</span>
    </button>
  </a-footer>
</a-modal>
