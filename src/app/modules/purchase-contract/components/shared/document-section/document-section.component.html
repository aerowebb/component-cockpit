<div class="grid-row">
  <div #documentsAnchor class="grid-cell--12" (click)="onChangeDocumentSelected()">
    <div class="grid-cell grid-cell--container" [ngClass]="{ active: documentSectionSelected }">
      <div class="grid-cell-header">
        <div class="grid-cell-title-container">
          <h3 class="grid-cell-title">
            {{ "global.documents" | translate }} ({{
              documentsTableDataSource ? documentsTableDataSource.dataCount : 0
            }})
          </h3>
        </div>
      </div>

      <div class="grid-cell-content">
        <a-table [dataSource]="documentsTableDataSource">
          <ng-template tableActionsDef>
            <div class="btn-file-upload-wrapper">
              <p-fileUpload
                #fileUploader
                *ngIf="!isReadOnlyForm && !documentsTableDataSource.hasDataSelection"
                name="document[]"
                customUpload="true"
                mode="basic"
                auto="true"
                chooseLabel="{{ 'global.upload' | translate }}"
                (uploadHandler)="uploadDocument($event, fileUploader)"
              ></p-fileUpload>
            </div>

            <button
              *ngIf="!isReadOnlyForm && !documentsTableDataSource.hasDataSelection"
              type="button"
              mat-raised-button
              (click)="linkUrl()"
            >
              {{ getComponentName() + ".linkUrl" | translate }}
            </button>

            <button *ngIf="showDownloadDocButton()" type="button" mat-raised-button (click)="downloadFiles()">
              {{ "global.download" | translate }}
            </button>

            <button *ngIf="showGoToDocButton()" type="button" mat-raised-button (click)="goToDoc()">
              {{ "global.goTo" | translate }}
            </button>

            <button
              *ngIf="!isReadOnlyForm && documentsTableDataSource.hasDataSelection"
              type="button"
              mat-raised-button
              color="warn"
              (click)="deleteDocuments()"
            >
              {{ "global.delete" | translate }}
            </button>

            <button
              *ngIf="!isReadOnlyForm && documentsTableDataSource.dataSelectionCount === 1"
              type="button"
              mat-raised-button
              (click)="editDocument()"
            >
              {{ "global.edit" | translate }}
            </button>

            <button
              *ngIf="documentsTableDataSource.dataSelectionCount === 1"
              type="button"
              mat-raised-button
              (click)="openDocument()"
            >
              {{ "global.open" | translate }}
            </button>
          </ng-template>
          <ng-template columnDef="documentName" let-rowData="rowData">
            <a (click)="downloadFiles(rowData)">{{ rowData.documentName }}</a>
          </ng-template>
          <ng-template columnDef="documentPublicationDate" let-rowData="rowData">
            {{ rowData.documentPublicationDate | date: "yyyy/MM/dd":"":translateService.currentLang }}
          </ng-template>
        </a-table>
      </div>
    </div>
  </div>
</div>

<aw-document-popup-form
  *ngIf="showDocumentDialog"
  [document]="currentDocument"
  [(display)]="showDocumentDialog"
  [isReadOnlyForm]="isReadOnlyDocumentDialog"
  (onValidated)="onUpdateDocument($event)"
></aw-document-popup-form>

<aw-document-url-popup-form
  *ngIf="showDocumentUrlDialog"
  [document]="currentDocument"
  [(display)]="showDocumentUrlDialog"
  [isReadOnlyForm]="isReadOnlyDocumentDialog"
  (onValidated)="onUpdateDocumentUrl($event)"
></aw-document-url-popup-form>
